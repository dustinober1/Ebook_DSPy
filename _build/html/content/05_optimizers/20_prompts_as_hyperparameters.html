
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Prompts as Auto-Optimized Hyperparameters &#8212; DSPy: The Complete Guide</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/05_optimizers/20_prompts_as_hyperparameters';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Minimal Data Training Pipelines" href="21_minimal_data_pipelines.html" />
    <link rel="prev" title="Instruction and Demonstration Interaction Effects" href="19_instruction_demonstration_interactions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../00_frontmatter/00_preface.html">
  
  
  
  
  
  
    <p class="title logo__title">DSPy: The Complete Guide</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00_frontmatter/01_how_to_use_this_book.html">How to Use This Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_frontmatter/02_prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_frontmatter/03_setup_instructions.html">Setup Instructions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 - Fundamentals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01_fundamentals/00_chapter_intro.html">Chapter 1: DSPy Fundamentals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/01_what_is_dspy.html">What is DSPy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/02_programming_vs_prompting.html">Programming vs. Prompting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/03_installation_setup.html">Installation and Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/04_first_dspy_program.html">Your First DSPy Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/05_language_models.html">Language Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/06_exercises.html">Chapter 1 Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 - Signatures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../02_signatures/00_chapter_intro.html">Chapter 2: Signatures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/01_understanding_signatures.html">Understanding Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/02_signature_syntax.html">Signature Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/03_typed_signatures.html">Typed Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/04_advanced_signatures.html">Advanced Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/05_practical_examples.html">Practical Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/06_exercises.html">Chapter 2 Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 - Modules</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../03_modules/00_chapter_intro.html">Chapter 3: Modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/01_module_basics.html">Module Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/02_predict_module.html">The Predict Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/02a_typed_predictor.html">TypedPredictor: Type-Safe Language Model Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/03_chainofthought.html">Chain of Thought Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/04_react_agents.html">ReAct Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/05_custom_modules.html">Custom Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/06_composing_modules.html">Composing Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/07_exercises.html">Chapter 3 Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/08_assertions.html">Assertions Module</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 4 - Evaluation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../04_evaluation/00_chapter_intro.html">Chapter 4: Evaluation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/01_why_evaluation_matters.html">Why Evaluation Matters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/02_creating_datasets.html">Creating Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/03_defining_metrics.html">Defining Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/04_evaluation_loops.html">Evaluation Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/05_best_practices.html">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/06_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/07_structured_prompting.html">Structured Prompting for Robust Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/08_llm_as_a_judge.html">LLM-as-a-Judge for Context-Sensitive Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/09_human_aligned_evaluation.html">Human-Aligned Evaluation: Capturing What Really Matters</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 5 - Optimizers</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="00_chapter_intro.html">Chapter 5: Optimizers &amp; Compilation</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_compilation_concept.html">The Compilation Concept in DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_bootstrapfewshot.html">BootstrapFewShot: Automatic Few-Shot Example Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="02a_copro.html">COPRO: Chain-of-Thought Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_mipro.html">MIPRO: Multi-step Instruction and Demonstration Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_knnfewshot.html">KNNFewShot: Similarity-Based Example Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_finetuning.html">Fine-Tuning Small Language Models in DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_choosing_optimizers.html">Choosing Optimizers: Decision Guide and Trade-offs</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_constraint_driven_optimization.html">Constraint-Driven Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_exercises.html">Chapter 5 Exercises: Optimizers &amp; Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_reflective_prompt_evolution.html">Reflective Prompt Evolution (RPE): Evolutionary Optimization Without Gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_copa_compiler_method.html">COPA: Compiler and Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="09a_copa_method.html">COPA: Combined Fine-Tuning and Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_joint_optimization.html">Joint Optimization: Fine-Tuning and Prompt Synergy</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_monte_carlo_optimization.html">Monte Carlo Optimization in DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_bayesian_optimization.html">Bayesian Optimization for Prompt Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_comprehensive_examples.html">Comprehensive Examples and Implementation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_multistage_optimization_theory.html">Multi-stage Optimization Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_instruction_tuning_frameworks.html">Instruction Tuning Frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_demonstration_optimization.html">Demonstration Optimization Strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="17_multistage_architectures.html">Multi-stage Program Architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_complex_pipeline_optimization.html">Optimization Strategies for Complex Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="19_instruction_demonstration_interactions.html">Instruction and Demonstration Interaction Effects</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Prompts as Auto-Optimized Hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="21_minimal_data_pipelines.html">Minimal Data Training Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="22_gepa_genetic_pareto_optimization.html">GEPA: Genetic-Pareto Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="23_state_space_prompt_optimization.html">State-Space Search for Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="24_inpars_plus_synthetic_data_ir.html">InPars+: Advanced Synthetic Data Generation for Information Retrieval</a></li>
<li class="toctree-l2"><a class="reference internal" href="25_custom_mipro_enhanced_optimization.html">CustomMIPROv2: Enhanced Multi-Stage Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="26_automatic_prompt_optimization_research.html">Automatic Prompt Optimization: When AI Outperforms Humans</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 6 - Real-World Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../06_real_world_applications/00_chapter_intro.html">Chapter 6: Building Real-World Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/01_rag_systems.html">RAG Systems: Building Intelligent Document Q&amp;A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/02_multi_hop_search.html">Multi-hop Search: Complex Reasoning Across Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/03_classification_tasks.html">Classification Tasks: Building Robust Text Categorization Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/04_entity_extraction.html">Entity Extraction: Mining Structured Information from Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/05_intelligent_agents.html">Intelligent Agents: Building Autonomous Problem-Solving Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/06_code_generation.html">Code Generation: Building Automated Programming Assistants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/07_exercises.html">Chapter 6 Exercises: Building Real-World Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/07a_perspective_driven_research.html">Perspective-Driven Research for Article Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/08_extreme_multilabel_classification.html">Extreme Multi-Label Classification: Scaling to Millions of Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/08a_long_form_generation.html">Long-form Article Generation with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/09_outline_generation.html">Outline Generation for Structured Article Writing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/11_extreme_few_shot_learning.html">Extreme Few-Shot Learning: Training with 10 Gold Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/12_ir_model_training_scratch.html">IR Model Training from Scratch: Methodology and Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/13_lingvarbench_healthcare_synthetic_data.html">LingVarBench: Synthetic Healthcare Transcript Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/14_scientific_figure_caption_generation.html">Scientific Figure Caption Generation with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/15_retrieval_augmented_guardrails.html">Retrieval-Augmented Guardrails for AI Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/16_graphrag_wikipedia_tidb_tutorial.html">GraphRAG from Wikipedia: Building with DSPy, OpenAI, and TiDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/17_framework_comparisons_dspy_ecosystem.html">Framework Comparisons in the DSPy Ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06_real_world_applications/18_multi_agent_rag_systems.html">Multi-Agent RAG Systems with DSPy</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 7 - Advanced Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../07_advanced_topics/00_chapter_intro.html">Chapter 7: Advanced Topics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/01_adapters_tools.html">Adapters and Tools: Extending DSPy Capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/02_caching_performance.html">Caching and Performance: Building High-Performance DSPy Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/03_async_streaming.html">Async and Streaming: Building Real-Time DSPy Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/04_debugging_tracing.html">Debugging and Tracing: Mastering DSPy Application Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/05_deployment_strategies.html">Deployment Strategies: Taking DSPy Applications to Production</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/06_exercises.html">Chapter 7 Exercises: Advanced Topics Mastery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/07_self_refining_pipelines.html">Self-Refining Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/08_declarative_compilation.html">Declarative Language Model Compilation Techniques</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 8 - Case Studies</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../08_case_studies/00_introduction.html">Chapter 8: Case Studies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/01_enterprise_rag_system.html">Case Study 1: Building an Enterprise RAG System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/01a_healthcare_clinical_notes.html">Case Study 1: Clinical Notes Analysis with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/02_customer_support_chatbot.html">Case Study 2: Developing a Customer Support Chatbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/03_ai_code_assistant.html">Case Study 3: Creating an AI-Powered Code Assistant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/04_automated_data_analysis.html">Case Study 4: Building an Automated Data Analysis Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/05_exercises.html">Chapter 8 Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/05a_storm_writing_assistant.html">Case Study 5: STORM - AI-Powered Writing Assistant for Wikipedia-like Articles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/06_assertion_driven_applications.html">Case Study: Assertion-Driven Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/07_databricks_jetblue_llm_optimization.html">Case Study 7: Databricks &amp; JetBlue LLM Pipeline Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/08_replit_code_repair_dspy.html">Case Study 8: Replit Code Repair with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/09_databricks_dspy_platform_integration.html">Case Study 9: Databricks Platform Integration with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/10_ddi_behavioral_simulation_automation.html">Case Study 10: DDI Behavioral Simulation Automation with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/11_salomatic_medical_report_generation.html">Case Study 11: Salomatic Medical Report Generation with DSPy and Langtrace</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../09_appendices/00_introduction.html">Chapter 9: Appendices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/01_api_reference_quick.html">API Reference Quick Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/02_troubleshooting.html">Troubleshooting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/03_resources.html">Additional Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/04_glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/05_community_resources.html">Community Resources and Perspectives</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/05_optimizers/20_prompts_as_hyperparameters.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Prompts as Auto-Optimized Hyperparameters</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-prompt-hyperparameter-framework">The Prompt Hyperparameter Framework</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-foundation">Conceptual Foundation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-prompt-hyperparameters">Types of Prompt Hyperparameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#auto-optimization-architecture">Auto-Optimization Architecture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-optimization-loop">The Optimization Loop</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-implementation-ir-model-training">Practical Implementation: IR Model Training</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-retrieval-with-optimized-prompts">Information Retrieval with Optimized Prompts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extreme-few-shot-learning-with-10-examples">Extreme Few-Shot Learning with 10 Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-challenge-of-minimal-data">The Challenge of Minimal Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-efficiency-framework">Data Efficiency Framework</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-pipeline-for-minimal-data">Training Pipeline for Minimal Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-10-example-training-pipeline">The 10-Example Training Pipeline</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#real-world-application-best-in-class-ir-with-10-labels">Real-World Application: Best-in-Class IR with 10 Labels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-implementation">Case Study Implementation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-analysis-and-validation">Performance Analysis and Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-success-with-minimal-data">Measuring Success with Minimal Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights-and-best-practices">Key Insights and Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principles-for-success-with-10-examples">Principles for Success with 10 Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-pitfalls-and-solutions">Common Pitfalls and Solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="prompts-as-auto-optimized-hyperparameters">
<h1>Prompts as Auto-Optimized Hyperparameters<a class="headerlink" href="#prompts-as-auto-optimized-hyperparameters" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In traditional machine learning, hyperparameters such as learning rate, batch size, and model architecture are carefully tuned to optimize performance. In the context of language models and DSPy, prompts themselves can be treated as trainable hyperparameters that are automatically optimized to maximize performance on specific tasks.</p>
<p>This revolutionary approach treats prompt engineering not as an art form requiring manual crafting, but as a systematic optimization problem where the optimal prompt is discovered through automated search and refinement.</p>
</section>
<section id="the-prompt-hyperparameter-framework">
<h2>The Prompt Hyperparameter Framework<a class="headerlink" href="#the-prompt-hyperparameter-framework" title="Link to this heading">#</a></h2>
<section id="conceptual-foundation">
<h3>Conceptual Foundation<a class="headerlink" href="#conceptual-foundation" title="Link to this heading">#</a></h3>
<p>When we treat prompts as hyperparameters, we’re fundamentally changing how we think about prompt engineering:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Traditional Approach:
Manual Prompt Design → Test → Manual Refinement → Repeat

DSPy Hyperparameter Approach:
Prompt Space Definition → Automated Optimization → Optimal Prompt
</pre></div>
</div>
</section>
<section id="types-of-prompt-hyperparameters">
<h3>Types of Prompt Hyperparameters<a class="headerlink" href="#types-of-prompt-hyperparameters" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Instruction Templates</strong>: The structure and wording of task instructions</p></li>
<li><p><strong>Few-shot Examples</strong>: Selection and ordering of demonstration examples</p></li>
<li><p><strong>Formatting Patterns</strong>: How inputs and outputs are presented</p></li>
<li><p><strong>Task Decomposition</strong>: How complex tasks are broken down</p></li>
<li><p><strong>Reasoning Steps</strong>: Explicit guidance for thinking processes</p></li>
</ol>
</section>
</section>
<section id="auto-optimization-architecture">
<h2>Auto-Optimization Architecture<a class="headerlink" href="#auto-optimization-architecture" title="Link to this heading">#</a></h2>
<section id="the-optimization-loop">
<h3>The Optimization Loop<a class="headerlink" href="#the-optimization-loop" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dspy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PromptHyperparameters</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Container for prompt hyperparameters&quot;&quot;&quot;</span>
    <span class="n">instruction_template</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">example_selection_strategy</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">formatting_pattern</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">reasoning_guidance</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">task_decomposition</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PromptHyperparameterOptimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automated prompt hyperparameter optimization&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">base_program</span><span class="p">:</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
                 <span class="n">metric_fn</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span>
                 <span class="n">search_space</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_program</span> <span class="o">=</span> <span class="n">base_program</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_fn</span> <span class="o">=</span> <span class="n">metric_fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span> <span class="o">=</span> <span class="n">search_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimization_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">trainset</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">],</span>
                 <span class="n">valset</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">],</span>
                 <span class="n">num_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PromptHyperparameters</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Optimize prompt hyperparameters using systematic search&quot;&quot;&quot;</span>

        <span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_score</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">):</span>
            <span class="c1"># Sample hyperparameters from search space</span>
            <span class="n">current_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_hyperparameters</span><span class="p">()</span>

            <span class="c1"># Create program with current hyperparameters</span>
            <span class="n">optimized_program</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hyperparameters</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">base_program</span><span class="p">,</span> <span class="n">current_params</span>
            <span class="p">)</span>

            <span class="c1"># Evaluate on validation set</span>
            <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_program</span><span class="p">(</span><span class="n">optimized_program</span><span class="p">,</span> <span class="n">valset</span><span class="p">)</span>

            <span class="c1"># Track best configuration</span>
            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
                <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>
                <span class="n">best_params</span> <span class="o">=</span> <span class="n">current_params</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">optimization_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;iteration&#39;</span><span class="p">:</span> <span class="n">iteration</span><span class="p">,</span>
                <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">current_params</span><span class="p">,</span>
                <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="n">score</span>
            <span class="p">})</span>

        <span class="k">return</span> <span class="n">best_params</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_sample_hyperparameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PromptHyperparameters</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample from hyperparameter search space&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PromptHyperparameters</span><span class="p">(</span>
            <span class="n">instruction_template</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">[</span><span class="s1">&#39;instruction_templates&#39;</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">example_selection_strategy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">[</span><span class="s1">&#39;example_strategies&#39;</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">formatting_pattern</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">[</span><span class="s1">&#39;formatting_patterns&#39;</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">reasoning_guidance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">[</span><span class="s1">&#39;reasoning_guidance&#39;</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">task_decomposition</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span><span class="p">[</span><span class="s1">&#39;task_decompositions&#39;</span><span class="p">],</span>
                <span class="n">size</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="practical-implementation-ir-model-training">
<h2>Practical Implementation: IR Model Training<a class="headerlink" href="#practical-implementation-ir-model-training" title="Link to this heading">#</a></h2>
<section id="information-retrieval-with-optimized-prompts">
<h3>Information Retrieval with Optimized Prompts<a class="headerlink" href="#information-retrieval-with-optimized-prompts" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OptimizedIRRetriever</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;IR model with prompts optimized as hyperparameters&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt_hyperparams</span><span class="p">:</span> <span class="n">PromptHyperparameters</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hyperparams</span> <span class="o">=</span> <span class="n">prompt_hyperparams</span>

        <span class="c1"># Core retrieval components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_encoder</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prompt_hyperparams</span><span class="o">.</span><span class="n">instruction_template</span><span class="si">}</span><span class="s2"> -&gt; encoded_query&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">document_ranker</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prompt_hyperparams</span><span class="o">.</span><span class="n">formatting_pattern</span><span class="si">}</span><span class="s2"> -&gt; ranked_documents&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">relevance_scorer</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prompt_hyperparams</span><span class="o">.</span><span class="n">reasoning_guidance</span><span class="si">}</span><span class="s2"> -&gt; relevance_score&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">documents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute optimized retrieval pipeline&quot;&quot;&quot;</span>

        <span class="c1"># Step 1: Encode query using optimized instruction</span>
        <span class="n">encoded_query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_encoder</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>

        <span class="c1"># Step 2: Apply task decomposition if specified</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hyperparams</span><span class="o">.</span><span class="n">task_decomposition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Break down complex query</span>
            <span class="n">sub_queries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decompose_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="n">all_results</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">sub_query</span> <span class="ow">in</span> <span class="n">sub_queries</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">document_ranker</span><span class="p">(</span>
                    <span class="n">query</span><span class="o">=</span><span class="n">sub_query</span><span class="p">,</span>
                    <span class="n">documents</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">documents</span><span class="p">),</span>
                    <span class="n">instruction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hyperparams</span><span class="o">.</span><span class="n">instruction_template</span>
                <span class="p">)</span>
                <span class="n">all_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

            <span class="c1"># Merge results from sub-queries</span>
            <span class="n">final_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_results</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Single query processing</span>
            <span class="n">final_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">document_ranker</span><span class="p">(</span>
                <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                <span class="n">documents</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">documents</span><span class="p">),</span>
                <span class="n">instruction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hyperparams</span><span class="o">.</span><span class="n">instruction_template</span>
            <span class="p">)</span>

        <span class="c1"># Step 3: Score relevance using optimized reasoning</span>
        <span class="n">ranked_docs</span> <span class="o">=</span> <span class="n">final_results</span><span class="o">.</span><span class="n">ranked_documents</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">scored_results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">ranked_docs</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>  <span class="c1"># Top 10 documents</span>
            <span class="n">score_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relevance_scorer</span><span class="p">(</span>
                <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                <span class="n">document</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span>
                <span class="n">reasoning_prompt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hyperparams</span><span class="o">.</span><span class="n">reasoning_guidance</span>
            <span class="p">)</span>
            <span class="n">scored_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;document&#39;</span><span class="p">:</span> <span class="n">doc</span><span class="p">,</span>
                <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">score_result</span><span class="o">.</span><span class="n">relevance_score</span><span class="p">),</span>
                <span class="s1">&#39;reasoning&#39;</span><span class="p">:</span> <span class="n">score_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reasoning&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="p">})</span>

        <span class="c1"># Sort by relevance score</span>
        <span class="n">scored_results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">ranked_documents</span><span class="o">=</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;document&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">scored_results</span><span class="p">],</span>
            <span class="n">relevance_scores</span><span class="o">=</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">scored_results</span><span class="p">],</span>
            <span class="n">reasoning_steps</span><span class="o">=</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;reasoning&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">scored_results</span><span class="p">],</span>
            <span class="n">encoded_query</span><span class="o">=</span><span class="n">encoded_query</span><span class="o">.</span><span class="n">encoded_query</span>
        <span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="extreme-few-shot-learning-with-10-examples">
<h2>Extreme Few-Shot Learning with 10 Examples<a class="headerlink" href="#extreme-few-shot-learning-with-10-examples" title="Link to this heading">#</a></h2>
<section id="the-challenge-of-minimal-data">
<h3>The Challenge of Minimal Data<a class="headerlink" href="#the-challenge-of-minimal-data" title="Link to this heading">#</a></h3>
<p>Training effective models with only 10 labeled examples represents the frontier of few-shot learning. Traditional approaches fail dramatically in this regime, but prompt hyperparameter optimization enables remarkable performance.</p>
</section>
<section id="data-efficiency-framework">
<h3>Data Efficiency Framework<a class="headerlink" href="#data-efficiency-framework" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ExtremeFewShotOptimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized optimizer for extreme few-shot scenarios&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_model</span> <span class="o">=</span> <span class="n">base_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_learning_cache</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">optimize_with_10_examples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                 <span class="n">task_signature</span><span class="p">:</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Signature</span><span class="p">,</span>
                                 <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">],</span>
                                 <span class="n">num_prompt_variations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Optimize for tasks with only 10 labeled examples&quot;&quot;&quot;</span>

        <span class="c1"># Step 1: Meta-prompt generation</span>
        <span class="n">meta_prompts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_meta_prompts</span><span class="p">(</span>
            <span class="n">task_signature</span><span class="p">,</span> <span class="n">num_prompt_variations</span>
        <span class="p">)</span>

        <span class="c1"># Step 2: Cross-validation with 10 examples</span>
        <span class="n">best_prompt</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_cv_score</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">for</span> <span class="n">meta_prompt</span> <span class="ow">in</span> <span class="n">meta_prompts</span><span class="p">:</span>
            <span class="c1"># Perform 5-fold cross-validation with 10 examples</span>
            <span class="n">cv_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cross_validate_with_10_examples</span><span class="p">(</span>
                <span class="n">meta_prompt</span><span class="p">,</span> <span class="n">examples</span><span class="p">,</span> <span class="n">task_signature</span>
            <span class="p">)</span>

            <span class="n">avg_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">avg_score</span> <span class="o">&gt;</span> <span class="n">best_cv_score</span><span class="p">:</span>
                <span class="n">best_cv_score</span> <span class="o">=</span> <span class="n">avg_score</span>
                <span class="n">best_prompt</span> <span class="o">=</span> <span class="n">meta_prompt</span>

        <span class="c1"># Step 3: Create optimized program with best prompt</span>
        <span class="n">optimized_program</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_optimized_program</span><span class="p">(</span>
            <span class="n">best_prompt</span><span class="p">,</span> <span class="n">task_signature</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">optimized_program</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_meta_prompts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">signature</span><span class="p">:</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Signature</span><span class="p">,</span>
                              <span class="n">num_variations</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate diverse meta-prompts for optimization&quot;&quot;&quot;</span>

        <span class="c1"># Use meta-learning to generate effective prompt variations</span>
        <span class="n">meta_instruction</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Generate </span><span class="si">{</span><span class="n">num_variations</span><span class="si">}</span><span class="s2"> different prompts for the following task:</span>
<span class="s2">        Task: </span><span class="si">{</span><span class="n">signature</span><span class="si">}</span>

<span class="s2">        Each prompt should:</span>
<span class="s2">        1. Use different instruction styles (direct, conversational, formal, creative)</span>
<span class="s2">        2. Include different levels of guidance (minimal, moderate, detailed)</span>
<span class="s2">        3. Suggest different reasoning approaches</span>
<span class="s2">        4. Vary in complexity and abstraction</span>

<span class="s2">        Make each prompt unique and optimized for few-shot learning.</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate using a powerful model</span>
        <span class="n">prompt_generator</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;task -&gt; prompt_variations&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">prompt_generator</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="n">meta_instruction</span><span class="p">)</span>

        <span class="c1"># Parse and clean the generated prompts</span>
        <span class="n">prompts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_prompts</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">prompt_variations</span><span class="p">)</span>

        <span class="c1"># Add domain-specific variations if examples provide clues</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta_learning_cache</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">domain_prompts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_domain_prompts</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>
            <span class="n">prompts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">domain_prompts</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">prompts</span><span class="p">[:</span><span class="n">num_variations</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_cross_validate_with_10_examples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                        <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                        <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">],</span>
                                        <span class="n">signature</span><span class="p">:</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Signature</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform cross-validation with only 10 examples&quot;&quot;&quot;</span>

        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Create 5 folds of 8 training, 2 testing examples</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_folds_with_10_examples</span><span class="p">(</span><span class="n">examples</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">fold_train</span><span class="p">,</span> <span class="n">fold_test</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">:</span>
            <span class="c1"># Create temporary program with current prompt</span>
            <span class="n">temp_program</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_program_with_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>

            <span class="c1"># Compile with training examples</span>
            <span class="n">optimizer</span> <span class="o">=</span> <span class="n">BootstrapFewShot</span><span class="p">(</span>
                <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_metric_for_task</span><span class="p">(</span><span class="n">signature</span><span class="p">),</span>
                <span class="n">max_bootstrapped_demos</span><span class="o">=</span><span class="mi">3</span>  <span class="c1"># Very few due to limited data</span>
            <span class="p">)</span>

            <span class="n">compiled</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">temp_program</span><span class="p">,</span> <span class="n">trainset</span><span class="o">=</span><span class="n">fold_train</span><span class="p">)</span>

            <span class="c1"># Evaluate on test examples</span>
            <span class="n">fold_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_on_examples</span><span class="p">(</span><span class="n">compiled</span><span class="p">,</span> <span class="n">fold_test</span><span class="p">)</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fold_score</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">scores</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_folds_with_10_examples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                     <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">],</span>
                                     <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create balanced cross-validation folds from 10 examples&quot;&quot;&quot;</span>

        <span class="c1"># Ensure balanced representation across classes if possible</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Use leave-two-out cross-validation for 10 examples</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)):</span>
                <span class="n">test_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">examples</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">examples</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
                <span class="n">train_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">ex</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>
                           <span class="k">if</span> <span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]]</span>

                <span class="c1"># Use only first 5 folds to limit computation</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">folds</span>
</pre></div>
</div>
</section>
</section>
<section id="training-pipeline-for-minimal-data">
<h2>Training Pipeline for Minimal Data<a class="headerlink" href="#training-pipeline-for-minimal-data" title="Link to this heading">#</a></h2>
<section id="the-10-example-training-pipeline">
<h3>The 10-Example Training Pipeline<a class="headerlink" href="#the-10-example-training-pipeline" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TenExampleTrainingPipeline</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete pipeline for training with minimal data&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">base_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">=</span> <span class="n">task_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_model</span> <span class="o">=</span> <span class="n">base_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_components</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_with_10_examples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">],</span>
                              <span class="n">task_signature</span><span class="p">:</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Signature</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Complete training pipeline using only 10 examples&quot;&quot;&quot;</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;examples_used&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">),</span>
            <span class="s1">&#39;optimization_steps&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;final_performance&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;trained_components&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>

        <span class="c1"># Step 1: Data Analysis and Augmentation</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 1: Analyzing and augmenting minimal data...&quot;</span><span class="p">)</span>
        <span class="n">augmented_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_augment_minimal_data</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;optimization_steps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Augmented </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span><span class="si">}</span><span class="s2"> examples to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">augmented_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Step 2: Prompt Hyperparameter Optimization</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2: Optimizing prompt hyperparameters...&quot;</span><span class="p">)</span>
        <span class="n">prompt_optimizer</span> <span class="o">=</span> <span class="n">ExtremeFewShotOptimizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_model</span><span class="p">)</span>
        <span class="n">optimized_program</span> <span class="o">=</span> <span class="n">prompt_optimizer</span><span class="o">.</span><span class="n">optimize_with_10_examples</span><span class="p">(</span>
            <span class="n">task_signature</span><span class="p">,</span> <span class="n">examples</span>
        <span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;trained_components&#39;</span><span class="p">][</span><span class="s1">&#39;optimized_program&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">optimized_program</span>

        <span class="c1"># Step 3: Meta-Learning Integration</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 3: Integrating meta-learning...&quot;</span><span class="p">)</span>
        <span class="n">meta_enhanced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_meta_learning</span><span class="p">(</span>
            <span class="n">optimized_program</span><span class="p">,</span> <span class="n">augmented_data</span>
        <span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;trained_components&#39;</span><span class="p">][</span><span class="s1">&#39;meta_enhanced&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta_enhanced</span>

        <span class="c1"># Step 4: Few-Shot Fine-Tuning</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 4: Applying few-shot fine-tuning...&quot;</span><span class="p">)</span>
        <span class="n">fine_tuned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_few_shot_fine_tune</span><span class="p">(</span><span class="n">meta_enhanced</span><span class="p">,</span> <span class="n">examples</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;trained_components&#39;</span><span class="p">][</span><span class="s1">&#39;fine_tuned&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fine_tuned</span>

        <span class="c1"># Step 5: Evaluation and Validation</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 5: Comprehensive evaluation...&quot;</span><span class="p">)</span>
        <span class="n">evaluation_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comprehensive_evaluation</span><span class="p">(</span>
            <span class="n">fine_tuned</span><span class="p">,</span> <span class="n">examples</span>
        <span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;final_performance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluation_results</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_augment_minimal_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strategically augment minimal training data&quot;&quot;&quot;</span>

        <span class="n">augmented</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Strategy 1: Paraphrase generation</span>
        <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">:</span>
            <span class="n">paraphraser</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;text -&gt; paraphrase&quot;</span><span class="p">)</span>
            <span class="n">para_result</span> <span class="o">=</span> <span class="n">paraphraser</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>

            <span class="n">new_example</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">with_inputs</span><span class="p">(</span>
                <span class="nb">input</span><span class="o">=</span><span class="n">para_result</span><span class="o">.</span><span class="n">paraphrase</span>
            <span class="p">)</span>
            <span class="n">augmented</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

        <span class="c1"># Strategy 2: Counterfactual generation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">,</span> <span class="s1">&#39;qa&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">:</span>
                <span class="n">counterfactual_gen</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
                    <span class="s2">&quot;example -&gt; counterfactual_example&quot;</span>
                <span class="p">)</span>
                <span class="n">cf_result</span> <span class="o">=</span> <span class="n">counterfactual_gen</span><span class="p">(</span>
                    <span class="n">example</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="c1"># Parse and add counterfactual example</span>
                <span class="n">cf_example</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_counterfactual</span><span class="p">(</span>
                    <span class="n">cf_result</span><span class="o">.</span><span class="n">counterfactual_example</span><span class="p">,</span> <span class="n">example</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">cf_example</span><span class="p">:</span>
                    <span class="n">augmented</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cf_example</span><span class="p">)</span>

        <span class="c1"># Strategy 3: Template-based generation</span>
        <span class="n">templates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_templates_from_examples</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">template</span> <span class="ow">in</span> <span class="n">templates</span><span class="p">:</span>
            <span class="n">template_gen</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;template -&gt; new_example_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">task_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">new_ex_result</span> <span class="o">=</span> <span class="n">template_gen</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>

            <span class="n">new_example</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_template_example</span><span class="p">(</span>
                <span class="n">new_ex_result</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;new_example_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">task_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span> <span class="n">example</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">new_example</span><span class="p">:</span>
                <span class="n">augmented</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_example</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">augmented</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_meta_learning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">program</span><span class="p">:</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
                            <span class="n">augmented_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply meta-learning to improve generalization&quot;&quot;&quot;</span>

        <span class="c1"># Create meta-learner that learns how to learn</span>
        <span class="n">meta_learner</span> <span class="o">=</span> <span class="n">MetaLearningWrapper</span><span class="p">(</span><span class="n">program</span><span class="p">)</span>

        <span class="c1"># Perform MAML-style adaptation with few examples</span>
        <span class="n">adapted_program</span> <span class="o">=</span> <span class="n">meta_learner</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span>
            <span class="n">support_set</span><span class="o">=</span><span class="n">augmented_data</span><span class="p">[:</span><span class="mi">8</span><span class="p">],</span>  <span class="c1"># Use 8 for adaptation</span>
            <span class="n">query_set</span><span class="o">=</span><span class="n">augmented_data</span><span class="p">[</span><span class="mi">8</span><span class="p">:],</span>    <span class="c1"># 2 for query</span>
            <span class="n">adaptation_steps</span><span class="o">=</span><span class="mi">3</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">adapted_program</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_few_shot_fine_tune</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                           <span class="n">program</span><span class="p">:</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
                           <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply specialized fine-tuning for few-shot scenarios&quot;&quot;&quot;</span>

        <span class="c1"># Use KNNFewShot for example-based learning</span>
        <span class="n">knn_optimizer</span> <span class="o">=</span> <span class="n">KNNFewShot</span><span class="p">(</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># Use 3 nearest neighbors</span>
            <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_adaptive_metric</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Compile with original 10 examples</span>
        <span class="n">fine_tuned</span> <span class="o">=</span> <span class="n">knn_optimizer</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">trainset</span><span class="o">=</span><span class="n">examples</span><span class="p">)</span>

        <span class="c1"># Add self-reflection capability</span>
        <span class="n">reflective_wrapper</span> <span class="o">=</span> <span class="n">ReflectiveWrapper</span><span class="p">(</span><span class="n">fine_tuned</span><span class="p">)</span>
        <span class="n">reflective_program</span> <span class="o">=</span> <span class="n">reflective_wrapper</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="n">trainset</span><span class="o">=</span><span class="n">examples</span><span class="p">,</span>
            <span class="n">reflection_steps</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">reflective_program</span>
</pre></div>
</div>
</section>
</section>
<section id="real-world-application-best-in-class-ir-with-10-labels">
<h2>Real-World Application: Best-in-Class IR with 10 Labels<a class="headerlink" href="#real-world-application-best-in-class-ir-with-10-labels" title="Link to this heading">#</a></h2>
<section id="case-study-implementation">
<h3>Case Study Implementation<a class="headerlink" href="#case-study-implementation" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BestInClassIRWith10Labels</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete implementation of IR system trained with only 10 labels&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_collection</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">documents</span> <span class="o">=</span> <span class="n">document_collection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retriever</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_and_deploy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">labeled_examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Train and deploy IR system with only 10 labeled examples&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labeled_examples</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This system requires exactly 10 labeled examples&quot;</span><span class="p">)</span>

        <span class="c1"># Phase 1: Setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_initial_components</span><span class="p">()</span>

        <span class="c1"># Phase 2: Train with extreme few-shot learning</span>
        <span class="n">training_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_with_10_examples</span><span class="p">(</span><span class="n">labeled_examples</span><span class="p">)</span>

        <span class="c1"># Phase 3: Optimize prompts as hyperparameters</span>
        <span class="n">optimized_retriever</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optimize_prompt_hyperparameters</span><span class="p">(</span>
            <span class="n">labeled_examples</span>
        <span class="p">)</span>

        <span class="c1"># Phase 4: Deploy with confidence estimation</span>
        <span class="n">deployed_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deploy_with_confidence_estimation</span><span class="p">(</span>
            <span class="n">optimized_retriever</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;training_results&#39;</span><span class="p">:</span> <span class="n">training_results</span><span class="p">,</span>
            <span class="s1">&#39;optimized_retriever&#39;</span><span class="p">:</span> <span class="n">optimized_retriever</span><span class="p">,</span>
            <span class="s1">&#39;deployed_system&#39;</span><span class="p">:</span> <span class="n">deployed_system</span><span class="p">,</span>
            <span class="s1">&#39;performance_metrics&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_measure_performance</span><span class="p">(</span><span class="n">deployed_system</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_initial_components</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup base IR components&quot;&quot;&quot;</span>

        <span class="c1"># Initialize base retriever with semantic search</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dspy.retrieve</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColBERTv2Retriever</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">base_retriever</span> <span class="o">=</span> <span class="n">ColBERTv2Retriever</span><span class="p">(</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># Retrieve more candidates for re-ranking</span>
            <span class="n">collection</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">documents</span>
        <span class="p">)</span>

        <span class="c1"># Initialize query processor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_processor</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;query -&gt; processed_query, search_intent&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Initialize document ranker</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">document_ranker</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
            <span class="s2">&quot;query, documents -&gt; ranked_documents&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_train_with_10_examples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                               <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Train system using only 10 examples&quot;&quot;&quot;</span>

        <span class="c1"># Create training pipeline</span>
        <span class="n">pipeline</span> <span class="o">=</span> <span class="n">TenExampleTrainingPipeline</span><span class="p">(</span>
            <span class="n">task_type</span><span class="o">=</span><span class="s2">&quot;information_retrieval&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Define IR-specific signature</span>
        <span class="n">ir_signature</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Signature</span><span class="p">(</span>
            <span class="s2">&quot;query, documents -&gt; relevant_documents, relevance_scores&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Train with minimal data</span>
        <span class="n">training_results</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">train_with_10_examples</span><span class="p">(</span>
            <span class="n">examples</span><span class="p">,</span> <span class="n">ir_signature</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">training_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">training_results</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">training_results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_optimize_prompt_hyperparameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                        <span class="n">examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Optimize prompts as hyperparameters for IR task&quot;&quot;&quot;</span>

        <span class="c1"># Define search space for prompt hyperparameters</span>
        <span class="n">search_space</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;instruction_templates&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Rank these documents by relevance to the query&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Order documents from most to least relevant&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Select and rank the most relevant documents&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Identify the top documents that answer this query&quot;</span>
            <span class="p">],</span>
            <span class="s1">&#39;example_strategies&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="s1">&#39;diverse&#39;</span><span class="p">,</span> <span class="s1">&#39;representative&#39;</span><span class="p">],</span>
            <span class="s1">&#39;formatting_patterns&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Query: </span><span class="si">{query}</span><span class="se">\n</span><span class="s2">Documents:</span><span class="se">\n</span><span class="si">{documents}</span><span class="se">\n</span><span class="s2">Ranking:&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Q: </span><span class="si">{query}</span><span class="se">\n</span><span class="s2">Docs: </span><span class="si">{documents}</span><span class="se">\n</span><span class="s2">Relevant:&quot;</span>
            <span class="p">],</span>
            <span class="s1">&#39;reasoning_guidance&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Consider semantic similarity and query-document matching&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Evaluate based on relevance, completeness, and authority&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Assess how well each document addresses the query&quot;</span>
            <span class="p">],</span>
            <span class="s1">&#39;task_decompositions&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="s1">&#39;direct_ranking&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;query_understanding&#39;</span><span class="p">,</span> <span class="s1">&#39;document_analysis&#39;</span><span class="p">,</span> <span class="s1">&#39;ranking&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;initial_filter&#39;</span><span class="p">,</span> <span class="s1">&#39;detailed_comparison&#39;</span><span class="p">,</span> <span class="s1">&#39;final_rank&#39;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="c1"># Create IR-specific program</span>
        <span class="n">base_ir_program</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_base_ir_program</span><span class="p">()</span>

        <span class="c1"># Optimize hyperparameters</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">PromptHyperparameterOptimizer</span><span class="p">(</span>
            <span class="n">base_program</span><span class="o">=</span><span class="n">base_ir_program</span><span class="p">,</span>
            <span class="n">metric_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ir_metric_function</span><span class="p">,</span>
            <span class="n">search_space</span><span class="o">=</span><span class="n">search_space</span>
        <span class="p">)</span>

        <span class="c1"># Use 8 examples for optimization, 2 for validation</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span>
            <span class="n">trainset</span><span class="o">=</span><span class="n">examples</span><span class="p">[:</span><span class="mi">8</span><span class="p">],</span>
            <span class="n">valset</span><span class="o">=</span><span class="n">examples</span><span class="p">[</span><span class="mi">8</span><span class="p">:],</span>
            <span class="n">num_iterations</span><span class="o">=</span><span class="mi">30</span>
        <span class="p">)</span>

        <span class="c1"># Apply best parameters</span>
        <span class="n">optimized_program</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hyperparameters</span><span class="p">(</span>
            <span class="n">base_ir_program</span><span class="p">,</span> <span class="n">best_params</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">optimized_program</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_base_ir_program</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create base IR program for optimization&quot;&quot;&quot;</span>

        <span class="k">class</span><span class="w"> </span><span class="nc">BaseIRProgram</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process_query</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
                    <span class="s2">&quot;query -&gt; processed_query, key_terms&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rank_documents</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
                    <span class="s2">&quot;query, documents -&gt; ranked_documents&quot;</span>
                <span class="p">)</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">documents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
                <span class="c1"># Process the query</span>
                <span class="n">processed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_query</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>

                <span class="c1"># Rank documents</span>
                <span class="n">ranked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank_documents</span><span class="p">(</span>
                    <span class="n">query</span><span class="o">=</span><span class="n">processed</span><span class="o">.</span><span class="n">processed_query</span><span class="p">,</span>
                    <span class="n">documents</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
                    <span class="n">ranked_documents</span><span class="o">=</span><span class="n">ranked</span><span class="o">.</span><span class="n">ranked_documents</span><span class="p">,</span>
                    <span class="n">processed_query</span><span class="o">=</span><span class="n">processed</span><span class="o">.</span><span class="n">processed_query</span><span class="p">,</span>
                    <span class="n">key_terms</span><span class="o">=</span><span class="n">processed</span><span class="o">.</span><span class="n">key_terms</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">BaseIRProgram</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-analysis-and-validation">
<h2>Performance Analysis and Validation<a class="headerlink" href="#performance-analysis-and-validation" title="Link to this heading">#</a></h2>
<section id="measuring-success-with-minimal-data">
<h3>Measuring Success with Minimal Data<a class="headerlink" href="#measuring-success-with-minimal-data" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_ir_with_10_examples</span><span class="p">(</span><span class="n">trained_system</span><span class="p">,</span>
                                <span class="n">test_queries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                                <span class="n">ground_truth</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Comprehensive evaluation of IR system trained with 10 examples&quot;&quot;&quot;</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;precision_at_k&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;recall_at_k&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;ndcg&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;mrr&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;confidence_calibration&#39;</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="p">}</span>

    <span class="c1"># Standard IR metrics</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
        <span class="n">precisions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">recalls</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">test_queries</span><span class="p">:</span>
            <span class="c1"># Get rankings from trained system</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">trained_system</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">documents</span><span class="o">=</span><span class="n">all_documents</span><span class="p">)</span>
            <span class="n">ranked_docs</span> <span class="o">=</span> <span class="n">parse_ranked_documents</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">ranked_documents</span><span class="p">)</span>

            <span class="c1"># Calculate precision@k</span>
            <span class="n">relevant_retrieved</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">ranked_docs</span><span class="p">[:</span><span class="n">k</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">[</span><span class="n">query</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">precision</span> <span class="o">=</span> <span class="n">relevant_retrieved</span> <span class="o">/</span> <span class="n">k</span>
            <span class="n">precisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>

            <span class="c1"># Calculate recall@k</span>
            <span class="n">total_relevant</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">[</span><span class="n">query</span><span class="p">])</span>
            <span class="n">recall</span> <span class="o">=</span> <span class="n">relevant_retrieved</span> <span class="o">/</span> <span class="n">total_relevant</span>
            <span class="n">recalls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>

        <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;precision_at_k&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">precisions</span><span class="p">)</span>
        <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;recall_at_k&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recalls</span><span class="p">)</span>

    <span class="c1"># NDCG calculation</span>
    <span class="n">ndcg_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">test_queries</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">trained_system</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">documents</span><span class="o">=</span><span class="n">all_documents</span><span class="p">)</span>
        <span class="n">ndcg</span> <span class="o">=</span> <span class="n">calculate_ndcg</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">[</span><span class="n">query</span><span class="p">])</span>
        <span class="n">ndcg_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ndcg</span><span class="p">)</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;ndcg&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ndcg_scores</span><span class="p">)</span>

    <span class="c1"># Mean Reciprocal Rank</span>
    <span class="n">mrr_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">test_queries</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">trained_system</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">documents</span><span class="o">=</span><span class="n">all_documents</span><span class="p">)</span>
        <span class="n">mrr</span> <span class="o">=</span> <span class="n">calculate_mrr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">[</span><span class="n">query</span><span class="p">])</span>
        <span class="n">mrr_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mrr</span><span class="p">)</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mrr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mrr_scores</span><span class="p">)</span>

    <span class="c1"># Confidence calibration (how well confidence scores predict accuracy)</span>
    <span class="n">calibration_score</span> <span class="o">=</span> <span class="n">calculate_confidence_calibration</span><span class="p">(</span>
        <span class="n">trained_system</span><span class="p">,</span> <span class="n">test_queries</span><span class="p">,</span> <span class="n">ground_truth</span>
    <span class="p">)</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;confidence_calibration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calibration_score</span>

    <span class="k">return</span> <span class="n">metrics</span>
</pre></div>
</div>
</section>
</section>
<section id="key-insights-and-best-practices">
<h2>Key Insights and Best Practices<a class="headerlink" href="#key-insights-and-best-practices" title="Link to this heading">#</a></h2>
<section id="principles-for-success-with-10-examples">
<h3>Principles for Success with 10 Examples<a class="headerlink" href="#principles-for-success-with-10-examples" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Prompt Quality Over Quantity</strong>: With minimal data, the prompt becomes the primary source of task knowledge</p></li>
<li><p><strong>Meta-Learning is Essential</strong>: Leverage knowledge from related tasks to compensate for data scarcity</p></li>
<li><p><strong>Strategic Data Augmentation</strong>: Every augmentation must be carefully designed to add meaningful variation</p></li>
<li><p><strong>Confidence Estimation</strong>: Critical when working with minimal training data</p></li>
<li><p><strong>Cross-Validation</strong>: Essential to prevent overfitting with such small datasets</p></li>
</ol>
</section>
<section id="common-pitfalls-and-solutions">
<h3>Common Pitfalls and Solutions<a class="headerlink" href="#common-pitfalls-and-solutions" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Pitfall</p></th>
<th class="head"><p>Solution</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Overfitting to 10 examples</p></td>
<td><p>Use rigorous cross-validation and regularization</p></td>
</tr>
<tr class="row-odd"><td><p>Poor prompt generalization</p></td>
<td><p>Optimize prompts as hyperparameters with diverse search</p></td>
</tr>
<tr class="row-even"><td><p>Catastrophic forgetting</p></td>
<td><p>Maintain meta-knowledge across updates</p></td>
</tr>
<tr class="row-odd"><td><p>Evaluation bias</p></td>
<td><p>Use held-out data and multiple metrics</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h2>
<p>In this section, we’ve explored how prompts can be treated as auto-optimized hyperparameters, enabling training of sophisticated models with minimal data. We’ve seen how this approach makes it possible to train best-in-class IR models with only 10 labeled examples.</p>
<p>Next, we’ll explore <a class="reference internal" href="#21-minimal-data-pipelines.md"><span class="xref myst">Minimal Data Training Pipelines</span></a>, which extends these concepts to create robust training systems for any task with minimal labeled data.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/05_optimizers"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="19_instruction_demonstration_interactions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Instruction and Demonstration Interaction Effects</p>
      </div>
    </a>
    <a class="right-next"
       href="21_minimal_data_pipelines.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Minimal Data Training Pipelines</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-prompt-hyperparameter-framework">The Prompt Hyperparameter Framework</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-foundation">Conceptual Foundation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-prompt-hyperparameters">Types of Prompt Hyperparameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#auto-optimization-architecture">Auto-Optimization Architecture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-optimization-loop">The Optimization Loop</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-implementation-ir-model-training">Practical Implementation: IR Model Training</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-retrieval-with-optimized-prompts">Information Retrieval with Optimized Prompts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extreme-few-shot-learning-with-10-examples">Extreme Few-Shot Learning with 10 Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-challenge-of-minimal-data">The Challenge of Minimal Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-efficiency-framework">Data Efficiency Framework</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-pipeline-for-minimal-data">Training Pipeline for Minimal Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-10-example-training-pipeline">The 10-Example Training Pipeline</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#real-world-application-best-in-class-ir-with-10-labels">Real-World Application: Best-in-Class IR with 10 Labels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-implementation">Case Study Implementation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-analysis-and-validation">Performance Analysis and Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-success-with-minimal-data">Measuring Success with Minimal Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights-and-best-practices">Key Insights and Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principles-for-success-with-10-examples">Principles for Success with 10 Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-pitfalls-and-solutions">Common Pitfalls and Solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dustin Ober
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>