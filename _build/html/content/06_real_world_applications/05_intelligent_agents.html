
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Intelligent Agents: Building Autonomous Problem-Solving Systems &#8212; DSPy: The Complete Guide</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/06_real_world_applications/05_intelligent_agents';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Code Generation: Building Automated Programming Assistants" href="06_code_generation.html" />
    <link rel="prev" title="Entity Extraction: Mining Structured Information from Text" href="04_entity_extraction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../00_frontmatter/00_preface.html">
  
  
  
  
  
  
    <p class="title logo__title">DSPy: The Complete Guide</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00_frontmatter/01_how_to_use_this_book.html">How to Use This Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_frontmatter/02_prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_frontmatter/03_setup_instructions.html">Setup Instructions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 - Fundamentals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01_fundamentals/00_chapter_intro.html">Chapter 1: DSPy Fundamentals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/01_what_is_dspy.html">What is DSPy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/02_programming_vs_prompting.html">Programming vs. Prompting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/03_installation_setup.html">Installation and Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/04_first_dspy_program.html">Your First DSPy Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/05_language_models.html">Language Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_fundamentals/06_exercises.html">Chapter 1 Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 - Signatures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../02_signatures/00_chapter_intro.html">Chapter 2: Signatures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/01_understanding_signatures.html">Understanding Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/02_signature_syntax.html">Signature Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/03_typed_signatures.html">Typed Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/04_advanced_signatures.html">Advanced Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/05_practical_examples.html">Practical Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_signatures/06_exercises.html">Chapter 2 Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 - Modules</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../03_modules/00_chapter_intro.html">Chapter 3: Modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/01_module_basics.html">Module Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/02_predict_module.html">The Predict Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/02a_typed_predictor.html">TypedPredictor: Type-Safe Language Model Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/03_chainofthought.html">Chain of Thought Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/04_react_agents.html">ReAct Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/05_custom_modules.html">Custom Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/06_composing_modules.html">Composing Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/07_exercises.html">Chapter 3 Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_modules/08_assertions.html">Assertions Module</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 4 - Evaluation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../04_evaluation/00_chapter_intro.html">Chapter 4: Evaluation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/01_why_evaluation_matters.html">Why Evaluation Matters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/02_creating_datasets.html">Creating Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/03_defining_metrics.html">Defining Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/04_evaluation_loops.html">Evaluation Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/05_best_practices.html">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/06_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/07_structured_prompting.html">Structured Prompting for Robust Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/08_llm_as_a_judge.html">LLM-as-a-Judge for Context-Sensitive Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_evaluation/09_human_aligned_evaluation.html">Human-Aligned Evaluation: Capturing What Really Matters</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 5 - Optimizers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../05_optimizers/00_chapter_intro.html">Chapter 5: Optimizers &amp; Compilation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/01_compilation_concept.html">The Compilation Concept in DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/02_bootstrapfewshot.html">BootstrapFewShot: Automatic Few-Shot Example Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/02a_copro.html">COPRO: Chain-of-Thought Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/03_mipro.html">MIPRO: Multi-step Instruction and Demonstration Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/04_knnfewshot.html">KNNFewShot: Similarity-Based Example Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/05_finetuning.html">Fine-Tuning Small Language Models in DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/06_choosing_optimizers.html">Choosing Optimizers: Decision Guide and Trade-offs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/07_constraint_driven_optimization.html">Constraint-Driven Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/07_exercises.html">Chapter 5 Exercises: Optimizers &amp; Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/08_reflective_prompt_evolution.html">Reflective Prompt Evolution (RPE): Evolutionary Optimization Without Gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/09_copa_compiler_method.html">COPA: Compiler and Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/09a_copa_method.html">COPA: Combined Fine-Tuning and Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/10_joint_optimization.html">Joint Optimization: Fine-Tuning and Prompt Synergy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/11_monte_carlo_optimization.html">Monte Carlo Optimization in DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/12_bayesian_optimization.html">Bayesian Optimization for Prompt Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/13_comprehensive_examples.html">Comprehensive Examples and Implementation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/14_multistage_optimization_theory.html">Multi-stage Optimization Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/15_instruction_tuning_frameworks.html">Instruction Tuning Frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/16_demonstration_optimization.html">Demonstration Optimization Strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/17_multistage_architectures.html">Multi-stage Program Architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/18_complex_pipeline_optimization.html">Optimization Strategies for Complex Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/19_instruction_demonstration_interactions.html">Instruction and Demonstration Interaction Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/20_prompts_as_hyperparameters.html">Prompts as Auto-Optimized Hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/21_minimal_data_pipelines.html">Minimal Data Training Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/22_gepa_genetic_pareto_optimization.html">GEPA: Genetic-Pareto Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/23_state_space_prompt_optimization.html">State-Space Search for Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/24_inpars_plus_synthetic_data_ir.html">InPars+: Advanced Synthetic Data Generation for Information Retrieval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/25_custom_mipro_enhanced_optimization.html">CustomMIPROv2: Enhanced Multi-Stage Prompt Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_optimizers/26_automatic_prompt_optimization_research.html">Automatic Prompt Optimization: When AI Outperforms Humans</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 6 - Real-World Applications</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="00_chapter_intro.html">Chapter 6: Building Real-World Applications</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_rag_systems.html">RAG Systems: Building Intelligent Document Q&amp;A</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_multi_hop_search.html">Multi-hop Search: Complex Reasoning Across Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_classification_tasks.html">Classification Tasks: Building Robust Text Categorization Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_entity_extraction.html">Entity Extraction: Mining Structured Information from Text</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Intelligent Agents: Building Autonomous Problem-Solving Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_code_generation.html">Code Generation: Building Automated Programming Assistants</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_exercises.html">Chapter 6 Exercises: Building Real-World Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="07a_perspective_driven_research.html">Perspective-Driven Research for Article Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_extreme_multilabel_classification.html">Extreme Multi-Label Classification: Scaling to Millions of Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="08a_long_form_generation.html">Long-form Article Generation with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_outline_generation.html">Outline Generation for Structured Article Writing</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_extreme_few_shot_learning.html">Extreme Few-Shot Learning: Training with 10 Gold Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_ir_model_training_scratch.html">IR Model Training from Scratch: Methodology and Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_lingvarbench_healthcare_synthetic_data.html">LingVarBench: Synthetic Healthcare Transcript Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_scientific_figure_caption_generation.html">Scientific Figure Caption Generation with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_retrieval_augmented_guardrails.html">Retrieval-Augmented Guardrails for AI Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_graphrag_wikipedia_tidb_tutorial.html">GraphRAG from Wikipedia: Building with DSPy, OpenAI, and TiDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="17_framework_comparisons_dspy_ecosystem.html">Framework Comparisons in the DSPy Ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_multi_agent_rag_systems.html">Multi-Agent RAG Systems with DSPy</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 7 - Advanced Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../07_advanced_topics/00_chapter_intro.html">Chapter 7: Advanced Topics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/01_adapters_tools.html">Adapters and Tools: Extending DSPy Capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/02_caching_performance.html">Caching and Performance: Building High-Performance DSPy Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/03_async_streaming.html">Async and Streaming: Building Real-Time DSPy Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/04_debugging_tracing.html">Debugging and Tracing: Mastering DSPy Application Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/05_deployment_strategies.html">Deployment Strategies: Taking DSPy Applications to Production</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/06_exercises.html">Chapter 7 Exercises: Advanced Topics Mastery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/07_self_refining_pipelines.html">Self-Refining Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_advanced_topics/08_declarative_compilation.html">Declarative Language Model Compilation Techniques</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 8 - Case Studies</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../08_case_studies/00_introduction.html">Chapter 8: Case Studies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/01_enterprise_rag_system.html">Case Study 1: Building an Enterprise RAG System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/01a_healthcare_clinical_notes.html">Case Study 1: Clinical Notes Analysis with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/02_customer_support_chatbot.html">Case Study 2: Developing a Customer Support Chatbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/03_ai_code_assistant.html">Case Study 3: Creating an AI-Powered Code Assistant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/04_automated_data_analysis.html">Case Study 4: Building an Automated Data Analysis Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/05_exercises.html">Chapter 8 Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/05a_storm_writing_assistant.html">Case Study 5: STORM - AI-Powered Writing Assistant for Wikipedia-like Articles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/06_assertion_driven_applications.html">Case Study: Assertion-Driven Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/07_databricks_jetblue_llm_optimization.html">Case Study 7: Databricks &amp; JetBlue LLM Pipeline Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/08_replit_code_repair_dspy.html">Case Study 8: Replit Code Repair with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/09_databricks_dspy_platform_integration.html">Case Study 9: Databricks Platform Integration with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/10_ddi_behavioral_simulation_automation.html">Case Study 10: DDI Behavioral Simulation Automation with DSPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_case_studies/11_salomatic_medical_report_generation.html">Case Study 11: Salomatic Medical Report Generation with DSPy and Langtrace</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../09_appendices/00_introduction.html">Chapter 9: Appendices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/01_api_reference_quick.html">API Reference Quick Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/02_troubleshooting.html">Troubleshooting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/03_resources.html">Additional Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/04_glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_appendices/05_community_resources.html">Community Resources and Perspectives</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/06_real_world_applications/05_intelligent_agents.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Intelligent Agents: Building Autonomous Problem-Solving Systems</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-intelligent-agents">Understanding Intelligent Agents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#core-components-of-an-agent">Core Components of an Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agent-types">Agent Types</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-intelligent-agents-with-dspy">Building Intelligent Agents with DSPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-reactive-agent">Basic Reactive Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proactive-agent-with-planning">Proactive Agent with Planning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collaborative-agent">Collaborative Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-agent">Learning Agent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#real-world-agent-applications">Real-World Agent Applications</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customer-service-agent">Customer Service Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#research-assistant-agent">Research Assistant Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#personal-finance-agent">Personal Finance Agent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-agent-behavior">Optimizing Agent Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mipro-for-agent-decision-making">Using MIPRO for Agent Decision Making</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practices-for-building-agents">Best Practices for Building Agents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clear-goal-definition">1. Clear Goal Definition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-error-handling">2. Robust Error Handling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-learning">3. Continuous Learning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaways">Key Takeaways</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="intelligent-agents-building-autonomous-problem-solving-systems">
<h1>Intelligent Agents: Building Autonomous Problem-Solving Systems<a class="headerlink" href="#intelligent-agents-building-autonomous-problem-solving-systems" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>Intelligent agents represent one of the most exciting applications of language models. These are autonomous systems that can perceive their environment, reason about problems, make decisions, and take actions to achieve specific goals. From customer service bots to research assistants, intelligent agents are transforming how we interact with and leverage AI in real-world scenarios.</p>
</section>
<section id="understanding-intelligent-agents">
<h2>Understanding Intelligent Agents<a class="headerlink" href="#understanding-intelligent-agents" title="Link to this heading">#</a></h2>
<section id="core-components-of-an-agent">
<h3>Core Components of an Agent<a class="headerlink" href="#core-components-of-an-agent" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Perception</strong>: Understanding the current state and environment</p></li>
<li><p><strong>Planning</strong>: Developing strategies to achieve goals</p></li>
<li><p><strong>Decision Making</strong>: Choosing the best course of action</p></li>
<li><p><strong>Execution</strong>: Carrying out planned actions</p></li>
<li><p><strong>Learning</strong>: Improving from experience and feedback</p></li>
<li><p><strong>Memory</strong>: Maintaining context and knowledge over time</p></li>
</ol>
</section>
<section id="agent-types">
<h3>Agent Types<a class="headerlink" href="#agent-types" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Reactive Agents</strong>: Respond directly to current inputs</p></li>
<li><p><strong>Proactive Agents</strong>: Anticipate future needs and take initiative</p></li>
<li><p><strong>Social Agents</strong>: Understand and respond to human emotions and social cues</p></li>
<li><p><strong>Collaborative Agents</strong>: Work with other agents or humans</p></li>
<li><p><strong>Learning Agents</strong>: Improve performance over time</p></li>
</ul>
</section>
</section>
<section id="building-intelligent-agents-with-dspy">
<h2>Building Intelligent Agents with DSPy<a class="headerlink" href="#building-intelligent-agents-with-dspy" title="Link to this heading">#</a></h2>
<section id="basic-reactive-agent">
<h3>Basic Reactive Agent<a class="headerlink" href="#basic-reactive-agent" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dspy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ReactiveAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">capabilities</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capabilities</span> <span class="o">=</span> <span class="n">capabilities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">perceive</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;input -&gt; perceived_state&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decide</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;state, capabilities -&gt; action, reasoning&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_text</span><span class="p">):</span>
        <span class="c1"># Perceive the current state</span>
        <span class="n">perception</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perceive</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">input_text</span><span class="p">)</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="n">perception</span><span class="o">.</span><span class="n">perceived_state</span>

        <span class="c1"># Decide on action</span>
        <span class="n">decision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decide</span><span class="p">(</span>
            <span class="n">state</span><span class="o">=</span><span class="n">current_state</span><span class="p">,</span>
            <span class="n">capabilities</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capabilities</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Store in memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">input_text</span><span class="p">,</span>
            <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">current_state</span><span class="p">,</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="n">decision</span><span class="o">.</span><span class="n">action</span><span class="p">,</span>
            <span class="s2">&quot;reasoning&quot;</span><span class="p">:</span> <span class="n">decision</span><span class="o">.</span><span class="n">reasoning</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">agent_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">perceived_state</span><span class="o">=</span><span class="n">current_state</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="n">decision</span><span class="o">.</span><span class="n">action</span><span class="p">,</span>
            <span class="n">reasoning</span><span class="o">=</span><span class="n">decision</span><span class="o">.</span><span class="n">reasoning</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_recent</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get recent memory entries.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="o">-</span><span class="n">num_recent</span><span class="p">:])</span>
</pre></div>
</div>
</section>
<section id="proactive-agent-with-planning">
<h3>Proactive Agent with Planning<a class="headerlink" href="#proactive-agent-with-planning" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ProactiveAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">goals</span><span class="p">,</span> <span class="n">tools</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goals</span> <span class="o">=</span> <span class="n">goals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tools</span> <span class="o">=</span> <span class="n">tools</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">understand_context</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;input -&gt; context, user_intent&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_plan</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span><span class="s2">&quot;context, intent, goals, tools -&gt; plan&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_step</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;plan, current_step, tools -&gt; action, next_step&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_progress</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;goal, current_state -&gt; progress_score, next_objective&quot;</span><span class="p">)</span>

        <span class="c1"># Persistent memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_plan</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_step</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_text</span><span class="p">):</span>
        <span class="c1"># Understand context and intent</span>
        <span class="n">understanding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">understand_context</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">input_text</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">understanding</span><span class="o">.</span><span class="n">context</span>
        <span class="n">intent</span> <span class="o">=</span> <span class="n">understanding</span><span class="o">.</span><span class="n">user_intent</span>

        <span class="c1"># Create or update plan</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_plan</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_needs_new_plan</span><span class="p">(</span><span class="n">intent</span><span class="p">):</span>
            <span class="n">planning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_plan</span><span class="p">(</span>
                <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                <span class="n">intent</span><span class="o">=</span><span class="n">intent</span><span class="p">,</span>
                <span class="n">goals</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">goals</span><span class="p">),</span>
                <span class="n">tools</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tools</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_plan</span> <span class="o">=</span> <span class="n">planning</span><span class="o">.</span><span class="n">plan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_step</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Execute current step</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_step</span><span class="p">(</span>
            <span class="n">plan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_plan</span><span class="p">,</span>
            <span class="n">current_step</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_step</span><span class="p">),</span>
            <span class="n">tools</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tools</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Evaluate progress</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_progress</span><span class="p">(</span>
            <span class="n">goal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">goals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># Primary goal</span>
            <span class="n">current_state</span><span class="o">=</span><span class="n">context</span>
        <span class="p">)</span>

        <span class="c1"># Update memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">),</span>
            <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">input_text</span><span class="p">,</span>
            <span class="s2">&quot;intent&quot;</span><span class="p">:</span> <span class="n">intent</span><span class="p">,</span>
            <span class="s2">&quot;action_taken&quot;</span><span class="p">:</span> <span class="n">execution</span><span class="o">.</span><span class="n">action</span><span class="p">,</span>
            <span class="s2">&quot;next_step&quot;</span><span class="p">:</span> <span class="n">execution</span><span class="o">.</span><span class="n">next_step</span><span class="p">,</span>
            <span class="s2">&quot;progress&quot;</span><span class="p">:</span> <span class="n">progress</span><span class="o">.</span><span class="n">progress_score</span>
        <span class="p">})</span>

        <span class="c1"># Update step</span>
        <span class="k">if</span> <span class="n">execution</span><span class="o">.</span><span class="n">next_step</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">execution</span><span class="o">.</span><span class="n">next_step</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">agent_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">user_intent</span><span class="o">=</span><span class="n">intent</span><span class="p">,</span>
            <span class="n">action_taken</span><span class="o">=</span><span class="n">execution</span><span class="o">.</span><span class="n">action</span><span class="p">,</span>
            <span class="n">current_plan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_plan</span><span class="p">,</span>
            <span class="n">progress</span><span class="o">=</span><span class="n">progress</span><span class="o">.</span><span class="n">progress_score</span><span class="p">,</span>
            <span class="n">next_objective</span><span class="o">=</span><span class="n">progress</span><span class="o">.</span><span class="n">next_objective</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_needs_new_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if we need a new plan based on intent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;new&quot;</span> <span class="ow">in</span> <span class="n">intent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;different&quot;</span> <span class="ow">in</span> <span class="n">intent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="collaborative-agent">
<h3>Collaborative Agent<a class="headerlink" href="#collaborative-agent" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CollaborativeAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">expertise</span><span class="p">,</span> <span class="n">team_members</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expertise</span> <span class="o">=</span> <span class="n">expertise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">team_members</span> <span class="o">=</span> <span class="n">team_members</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyze_task</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;task -&gt; task_type, complexity, requirements&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delegate_or_handle</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;task, expertise, team_members -&gt; decision, rationale, delegation_details&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collaborate</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
            <span class="s2">&quot;task, member_expertise -&gt; collaboration_message&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">synthesize_results</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;task, individual_results -&gt; final_result, confidence&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Team communication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_context</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
        <span class="c1"># Analyze the task</span>
        <span class="n">analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_task</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">)</span>

        <span class="c1"># Decide whether to handle or delegate</span>
        <span class="n">decision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delegate_or_handle</span><span class="p">(</span>
            <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span>
            <span class="n">expertise</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">expertise</span><span class="p">,</span>
            <span class="n">team_members</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;expertise&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">team_members</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">decision</span><span class="o">.</span><span class="n">decision</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;handle myself&quot;</span><span class="p">:</span>
            <span class="c1"># Handle the task personally</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Delegate to team member</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delegate_task</span><span class="p">(</span>
                <span class="n">task</span><span class="p">,</span>
                <span class="n">decision</span><span class="o">.</span><span class="n">delegation_details</span><span class="p">,</span>
                <span class="n">decision</span><span class="o">.</span><span class="n">rationale</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">agent_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">task_analysis</span><span class="o">=</span><span class="n">analysis</span><span class="p">,</span>
            <span class="n">decision</span><span class="o">=</span><span class="n">decision</span><span class="o">.</span><span class="n">decision</span><span class="p">,</span>
            <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
            <span class="n">rationale</span><span class="o">=</span><span class="n">decision</span><span class="o">.</span><span class="n">rationale</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_handle_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle task personally based on expertise.&quot;&quot;&quot;</span>
        <span class="c1"># Implementation would depend on specific expertise</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Handled </span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expertise</span><span class="si">}</span><span class="s2"> expertise&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_delegate_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">delegation_details</span><span class="p">,</span> <span class="n">rationale</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegate task to appropriate team member.&quot;&quot;&quot;</span>
        <span class="c1"># Find appropriate team member</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">team_members</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">member</span><span class="p">[</span><span class="s2">&quot;expertise&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">delegation_details</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="c1"># Send collaboration message</span>
                <span class="n">collab_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collaborate</span><span class="p">(</span>
                    <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span>
                    <span class="n">member_expertise</span><span class="o">=</span><span class="n">member</span><span class="p">[</span><span class="s2">&quot;expertise&quot;</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="c1"># Record collaboration</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">member</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">collab_msg</span><span class="o">.</span><span class="n">collaboration_message</span><span class="p">,</span>
                    <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="n">task</span>
                <span class="p">})</span>

                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Delegated </span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">member</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (Expertise: </span><span class="si">{</span><span class="n">member</span><span class="p">[</span><span class="s1">&#39;expertise&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;No suitable team member found for: </span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_team_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">expertise</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new team member.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">team_members</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;expertise&quot;</span><span class="p">:</span> <span class="n">expertise</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="learning-agent">
<h3>Learning Agent<a class="headerlink" href="#learning-agent" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LearningAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">learning_goals</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_goals</span> <span class="o">=</span> <span class="n">learning_goals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_input</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;input -&gt; processed_input, key_patterns&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_response</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;processed_input, past_experiences -&gt; response, confidence&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_outcome</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;response, feedback -&gt; learning_insight, strategy_update&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reflect</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span><span class="s2">&quot;experience, goal -&gt; reflection, improvement_plan&quot;</span><span class="p">)</span>

        <span class="c1"># Learning components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiences</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store past interactions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patterns</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1"># Learned patterns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strategies</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1"># Effective strategies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_text</span><span class="p">,</span> <span class="n">feedback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Process input</span>
        <span class="n">processed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_input</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">input_text</span><span class="p">)</span>

        <span class="c1"># Generate response based on experience</span>
        <span class="n">relevant_experiences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_relevant_experiences</span><span class="p">(</span><span class="n">processed</span><span class="o">.</span><span class="n">key_patterns</span><span class="p">)</span>
        <span class="n">experiences_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">relevant_experiences</span><span class="p">])</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_response</span><span class="p">(</span>
            <span class="n">processed_input</span><span class="o">=</span><span class="n">processed</span><span class="o">.</span><span class="n">processed_input</span><span class="p">,</span>
            <span class="n">past_experiences</span><span class="o">=</span><span class="n">experiences_text</span>
        <span class="p">)</span>

        <span class="c1"># Store experience</span>
        <span class="n">experience</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiences</span><span class="p">),</span>
            <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">input_text</span><span class="p">,</span>
            <span class="s2">&quot;processed&quot;</span><span class="p">:</span> <span class="n">processed</span><span class="o">.</span><span class="n">processed_input</span><span class="p">,</span>
            <span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">response</span><span class="p">,</span>
            <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">confidence</span><span class="p">,</span>
            <span class="s2">&quot;patterns&quot;</span><span class="p">:</span> <span class="n">processed</span><span class="o">.</span><span class="n">key_patterns</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experience</span><span class="p">)</span>

        <span class="c1"># Learn from feedback if available</span>
        <span class="k">if</span> <span class="n">feedback</span><span class="p">:</span>
            <span class="n">learning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_outcome</span><span class="p">(</span>
                <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">response</span><span class="p">,</span>
                <span class="n">feedback</span><span class="o">=</span><span class="n">feedback</span>
            <span class="p">)</span>

            <span class="c1"># Update learning</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_learning</span><span class="p">(</span>
                <span class="n">processed</span><span class="o">.</span><span class="n">key_patterns</span><span class="p">,</span>
                <span class="n">learning</span><span class="o">.</span><span class="n">learning_insight</span><span class="p">,</span>
                <span class="n">learning</span><span class="o">.</span><span class="n">strategy_update</span>
            <span class="p">)</span>

            <span class="c1"># Reflect on the experience</span>
            <span class="n">reflection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span>
                <span class="n">experience</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">experience</span><span class="p">),</span>
                <span class="n">goal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_goals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">experience</span><span class="p">[</span><span class="s2">&quot;feedback&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feedback</span>
            <span class="n">experience</span><span class="p">[</span><span class="s2">&quot;learning&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">learning</span><span class="o">.</span><span class="n">learning_insight</span>
            <span class="n">experience</span><span class="p">[</span><span class="s2">&quot;reflection&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reflection</span><span class="o">.</span><span class="n">reflection</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">agent_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">response</span><span class="p">,</span>
            <span class="n">confidence</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">confidence</span><span class="p">,</span>
            <span class="n">patterns_detected</span><span class="o">=</span><span class="n">processed</span><span class="o">.</span><span class="n">key_patterns</span><span class="p">,</span>
            <span class="n">learning_applied</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">feedback</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_relevant_experiences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">max_experiences</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find past experiences with similar patterns.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">patterns</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">pattern_list</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">patterns</span>
        <span class="n">relevant</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiences</span><span class="p">:</span>
            <span class="n">exp_patterns</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;patterns&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;patterns&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="n">overlap</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pattern_list</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">exp_patterns</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">overlap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">relevant</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">exp</span><span class="p">,</span> <span class="n">overlap</span><span class="p">))</span>

        <span class="c1"># Sort by relevance and return top matches</span>
        <span class="n">relevant</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">exp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">relevant</span><span class="p">[:</span><span class="n">max_experiences</span><span class="p">]]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_learning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">insight</span><span class="p">,</span> <span class="n">strategy_update</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update learned patterns and strategies.&quot;&quot;&quot;</span>
        <span class="c1"># Update patterns</span>
        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pattern</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">patterns</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">pattern</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">pattern</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">insight</span><span class="p">)</span>

        <span class="c1"># Update strategies</span>
        <span class="k">if</span> <span class="n">strategy_update</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span>  <span class="c1"># Use first 50 chars as key</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">strategies</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy_update</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_learning_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get summary of learning progress.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;total_experiences&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiences</span><span class="p">),</span>
            <span class="s2">&quot;patterns_learned&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patterns</span><span class="p">),</span>
            <span class="s2">&quot;strategies_developed&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strategies</span><span class="p">),</span>
            <span class="s2">&quot;recent_performance&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="real-world-agent-applications">
<h2>Real-World Agent Applications<a class="headerlink" href="#real-world-agent-applications" title="Link to this heading">#</a></h2>
<section id="customer-service-agent">
<h3>Customer Service Agent<a class="headerlink" href="#customer-service-agent" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CustomerServiceAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">company_name</span><span class="p">,</span> <span class="n">knowledge_base</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">company_name</span> <span class="o">=</span> <span class="n">company_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knowledge_base</span> <span class="o">=</span> <span class="n">knowledge_base</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classify_intent</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;customer_message -&gt; intent, urgency, sentiment&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_knowledge</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Retrieve</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_response</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;intent, sentiment, knowledge, company_policy -&gt; response, action_needed&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">escalate</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;issue, customer_details -&gt; escalation_reason, department&quot;</span><span class="p">)</span>

        <span class="c1"># Session management</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_message</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Get or create session</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">session_id</span><span class="p">:</span>
            <span class="n">session_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">)</span>
        <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;history&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;context&quot;</span><span class="p">:</span> <span class="p">{}})</span>

        <span class="c1"># Classify the customer&#39;s intent</span>
        <span class="n">classification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_intent</span><span class="p">(</span><span class="n">customer_message</span><span class="o">=</span><span class="n">customer_message</span><span class="p">)</span>

        <span class="c1"># Search knowledge base</span>
        <span class="n">relevant_kb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_knowledge</span><span class="p">(</span>
            <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">classification</span><span class="o">.</span><span class="n">intent</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">customer_message</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Generate response</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_response</span><span class="p">(</span>
            <span class="n">intent</span><span class="o">=</span><span class="n">classification</span><span class="o">.</span><span class="n">intent</span><span class="p">,</span>
            <span class="n">sentiment</span><span class="o">=</span><span class="n">classification</span><span class="o">.</span><span class="n">sentiment</span><span class="p">,</span>
            <span class="n">knowledge</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">relevant_kb</span><span class="o">.</span><span class="n">passages</span><span class="p">),</span>
            <span class="n">company_policy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">knowledge_base</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;policies&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Determine if escalation is needed</span>
        <span class="n">action_needed</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">action_needed</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">action_needed</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;escalate&quot;</span> <span class="ow">in</span> <span class="n">action_needed</span> <span class="ow">or</span> <span class="s2">&quot;urgent&quot;</span> <span class="ow">in</span> <span class="n">classification</span><span class="o">.</span><span class="n">urgency</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">escalation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">escalate</span><span class="p">(</span>
                <span class="n">issue</span><span class="o">=</span><span class="n">customer_message</span><span class="p">,</span>
                <span class="n">customer_details</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">final_action</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Escalated to </span><span class="si">{</span><span class="n">escalation</span><span class="o">.</span><span class="n">department</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">escalation</span><span class="o">.</span><span class="n">escalation_reason</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">final_action</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">action_needed</span>

        <span class="c1"># Update session</span>
        <span class="n">session</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;customer_message&quot;</span><span class="p">:</span> <span class="n">customer_message</span><span class="p">,</span>
            <span class="s2">&quot;agent_response&quot;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">response</span><span class="p">,</span>
            <span class="s2">&quot;intent&quot;</span><span class="p">:</span> <span class="n">classification</span><span class="o">.</span><span class="n">intent</span><span class="p">,</span>
            <span class="s2">&quot;sentiment&quot;</span><span class="p">:</span> <span class="n">classification</span><span class="o">.</span><span class="n">sentiment</span><span class="p">,</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="n">final_action</span>
        <span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">session_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">session</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">response</span><span class="p">,</span>
            <span class="n">intent</span><span class="o">=</span><span class="n">classification</span><span class="o">.</span><span class="n">intent</span><span class="p">,</span>
            <span class="n">sentiment</span><span class="o">=</span><span class="n">classification</span><span class="o">.</span><span class="n">sentiment</span><span class="p">,</span>
            <span class="n">action_required</span><span class="o">=</span><span class="n">final_action</span><span class="p">,</span>
            <span class="n">agent_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">company_name</span><span class="si">}</span><span class="s2"> Support Agent&quot;</span>
        <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="research-assistant-agent">
<h3>Research Assistant Agent<a class="headerlink" href="#research-assistant-agent" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ResearchAssistantAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">research_domains</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">research_domains</span> <span class="o">=</span> <span class="n">research_domains</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plan_research</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span><span class="s2">&quot;research_question -&gt; research_plan, methodology&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_papers</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Retrieve</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyze_papers</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;papers, research_question -&gt; key_findings, methodologies&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">synthesize_insights</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;findings, methodologies, research_question -&gt; synthesis, knowledge_gaps&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suggest_next_steps</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;synthesis, gaps -&gt; next_research_steps&quot;</span>

        <span class="c1"># Research state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_research</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">research_question</span><span class="p">,</span> <span class="n">research_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">research_id</span><span class="p">:</span>
            <span class="n">research_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_research</span><span class="p">)</span>

        <span class="c1"># Plan the research</span>
        <span class="n">planning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plan_research</span><span class="p">(</span><span class="n">research_question</span><span class="o">=</span><span class="n">research_question</span><span class="p">)</span>

        <span class="c1"># Search for relevant papers</span>
        <span class="n">search_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_papers</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">research_question</span><span class="p">)</span>

        <span class="c1"># Analyze the papers</span>
        <span class="n">analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_papers</span><span class="p">(</span>
            <span class="n">papers</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">search_results</span><span class="o">.</span><span class="n">passages</span><span class="p">),</span>
            <span class="n">research_question</span><span class="o">=</span><span class="n">research_question</span>
        <span class="p">)</span>

        <span class="c1"># Synthesize insights</span>
        <span class="n">synthesis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">synthesize_insights</span><span class="p">(</span>
            <span class="n">findings</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">key_findings</span><span class="p">,</span>
            <span class="n">methodologies</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">methodologies</span><span class="p">,</span>
            <span class="n">research_question</span><span class="o">=</span><span class="n">research_question</span>
        <span class="p">)</span>

        <span class="c1"># Suggest next steps</span>
        <span class="n">next_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggest_next_steps</span><span class="p">(</span>
            <span class="n">synthesis</span><span class="o">=</span><span class="n">synthesis</span><span class="o">.</span><span class="n">synthesis</span><span class="p">,</span>
            <span class="n">gaps</span><span class="o">=</span><span class="n">synthesis</span><span class="o">.</span><span class="n">knowledge_gaps</span>
        <span class="p">)</span>

        <span class="c1"># Store research state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_research</span><span class="p">[</span><span class="n">research_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="n">research_question</span><span class="p">,</span>
            <span class="s2">&quot;plan&quot;</span><span class="p">:</span> <span class="n">planning</span><span class="o">.</span><span class="n">research_plan</span><span class="p">,</span>
            <span class="s2">&quot;papers_found&quot;</span><span class="p">:</span> <span class="n">search_results</span><span class="o">.</span><span class="n">passages</span><span class="p">,</span>
            <span class="s2">&quot;findings&quot;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">key_findings</span><span class="p">,</span>
            <span class="s2">&quot;synthesis&quot;</span><span class="p">:</span> <span class="n">synthesis</span><span class="o">.</span><span class="n">synthesis</span><span class="p">,</span>
            <span class="s2">&quot;next_steps&quot;</span><span class="p">:</span> <span class="n">next_steps</span><span class="o">.</span><span class="n">next_research_steps</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;in_progress&quot;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">research_id</span><span class="o">=</span><span class="n">research_id</span><span class="p">,</span>
            <span class="n">research_plan</span><span class="o">=</span><span class="n">planning</span><span class="o">.</span><span class="n">research_plan</span><span class="p">,</span>
            <span class="n">key_findings</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">key_findings</span><span class="p">,</span>
            <span class="n">synthesis</span><span class="o">=</span><span class="n">synthesis</span><span class="o">.</span><span class="n">synthesis</span><span class="p">,</span>
            <span class="n">knowledge_gaps</span><span class="o">=</span><span class="n">synthesis</span><span class="o">.</span><span class="n">knowledge_gaps</span><span class="p">,</span>
            <span class="n">next_steps</span><span class="o">=</span><span class="n">next_steps</span><span class="o">.</span><span class="n">next_research_steps</span><span class="p">,</span>
            <span class="n">papers_analyzed</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">search_results</span><span class="o">.</span><span class="n">passages</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="personal-finance-agent">
<h3>Personal Finance Agent<a class="headerlink" href="#personal-finance-agent" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">PersonalFinanceAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_profile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_profile</span> <span class="o">=</span> <span class="n">user_profile</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyze_transaction</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;transaction -&gt; category, necessity, impact&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assess_financial_health</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;income, expenses, goals -&gt; health_score, recommendations&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suggest_optimization</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
            <span class="s2">&quot;spending_patterns, financial_goals -&gt; optimization_suggestions&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict_future</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;current_trends, income_stability -&gt; future_outlook&quot;</span>

        <span class="c1"># Financial data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transactions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goals</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a financial transaction.&quot;&quot;&quot;</span>
        <span class="n">analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_transaction</span><span class="p">(</span>
            <span class="n">transaction</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">: $</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">transaction</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transactions</span><span class="p">),</span>
            <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
            <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
            <span class="s2">&quot;necessity&quot;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">necessity</span><span class="p">,</span>
            <span class="s2">&quot;impact&quot;</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">impact</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">transactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">transaction</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_financial_advice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get personalized financial advice.&quot;&quot;&quot;</span>
        <span class="c1"># Calculate totals</span>
        <span class="n">income</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transactions</span> <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">expenses</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transactions</span> <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Assess financial health</span>
        <span class="n">health</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assess_financial_health</span><span class="p">(</span>
            <span class="n">income</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">income</span><span class="p">),</span>
            <span class="n">expenses</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">expenses</span><span class="p">),</span>
            <span class="n">goals</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">goals</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Analyze spending patterns</span>
        <span class="n">spending_by_category</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transactions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Expense</span>
                <span class="n">cat</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span>
                <span class="n">spending_by_category</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">spending_by_category</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">])</span>

        <span class="c1"># Get optimization suggestions</span>
        <span class="n">optimization</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggest_optimization</span><span class="p">(</span>
            <span class="n">spending_patterns</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">spending_by_category</span><span class="p">),</span>
            <span class="n">financial_goals</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">goals</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Predict future outlook</span>
        <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_future</span><span class="p">(</span>
            <span class="n">current_trends</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">spending_by_category</span><span class="p">),</span>
            <span class="n">income_stability</span><span class="o">=</span><span class="s2">&quot;stable&quot;</span>  <span class="c1"># Could be more sophisticated</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">health_score</span><span class="o">=</span><span class="n">health</span><span class="o">.</span><span class="n">health_score</span><span class="p">,</span>
            <span class="n">recommendations</span><span class="o">=</span><span class="n">health</span><span class="o">.</span><span class="n">recommendations</span><span class="p">,</span>
            <span class="n">optimization_suggestions</span><span class="o">=</span><span class="n">optimization</span><span class="o">.</span><span class="n">optimization_suggestions</span><span class="p">,</span>
            <span class="n">future_outlook</span><span class="o">=</span><span class="n">future</span><span class="o">.</span><span class="n">future_outlook</span><span class="p">,</span>
            <span class="n">spending_breakdown</span><span class="o">=</span><span class="n">spending_by_category</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_goal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal_description</span><span class="p">,</span> <span class="n">target_amount</span><span class="p">,</span> <span class="n">deadline</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a financial goal.&quot;&quot;&quot;</span>
        <span class="n">goal</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">goals</span><span class="p">),</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">goal_description</span><span class="p">,</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">target_amount</span><span class="p">,</span>
            <span class="s2">&quot;deadline&quot;</span><span class="p">:</span> <span class="n">deadline</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">goal</span>
</pre></div>
</div>
</section>
</section>
<section id="optimizing-agent-behavior">
<h2>Optimizing Agent Behavior<a class="headerlink" href="#optimizing-agent-behavior" title="Link to this heading">#</a></h2>
<section id="using-mipro-for-agent-decision-making">
<h3>Using MIPRO for Agent Decision Making<a class="headerlink" href="#using-mipro-for-agent-decision-making" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OptimizedDecisionAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decision_context</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">decision_context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyze_situation</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;situation, context -&gt; situation_analysis, key_factors&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consider_options</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
            <span class="s2">&quot;analysis, factors, constraints -&gt; options, pros_cons&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_decision</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;analysis, options, pros_cons, objectives -&gt; decision, confidence, reasoning&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">situation</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objectives</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Analyze the situation</span>
        <span class="n">analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_situation</span><span class="p">(</span>
            <span class="n">situation</span><span class="o">=</span><span class="n">situation</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span>
        <span class="p">)</span>

        <span class="c1"># Consider available options</span>
        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consider_options</span><span class="p">(</span>
            <span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">situation_analysis</span><span class="p">,</span>
            <span class="n">factors</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">key_factors</span><span class="p">,</span>
            <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span> <span class="ow">or</span> <span class="s2">&quot;No explicit constraints&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Make decision</span>
        <span class="n">decision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_decision</span><span class="p">(</span>
            <span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">situation_analysis</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="n">pros_cons</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">pros_cons</span><span class="p">,</span>
            <span class="n">objectives</span><span class="o">=</span><span class="n">objectives</span> <span class="ow">or</span> <span class="s2">&quot;Optimize outcomes&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Prediction</span><span class="p">(</span>
            <span class="n">decision</span><span class="o">=</span><span class="n">decision</span><span class="o">.</span><span class="n">decision</span><span class="p">,</span>
            <span class="n">confidence</span><span class="o">=</span><span class="n">decision</span><span class="o">.</span><span class="n">confidence</span><span class="p">,</span>
            <span class="n">reasoning</span><span class="o">=</span><span class="n">decision</span><span class="o">.</span><span class="n">reasoning</span><span class="p">,</span>
            <span class="n">alternatives</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">options</span>
        <span class="p">)</span>

<span class="c1"># Training data for agent decision making</span>
<span class="n">decision_trainset</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">dspy</span><span class="o">.</span><span class="n">Example</span><span class="p">(</span>
        <span class="n">situation</span><span class="o">=</span><span class="s2">&quot;Customer reports system downtime affecting 1000 users&quot;</span><span class="p">,</span>
        <span class="n">context</span><span class="o">=</span><span class="s2">&quot;Technical support with SLA requirements&quot;</span><span class="p">,</span>
        <span class="n">constraints</span><span class="o">=</span><span class="s2">&quot;Must resolve within 1 hour, limited team available&quot;</span><span class="p">,</span>
        <span class="n">objectives</span><span class="o">=</span><span class="s2">&quot;Minimize downtime, maintain customer satisfaction&quot;</span><span class="p">,</span>
        <span class="n">decision</span><span class="o">=</span><span class="s2">&quot;Escalate to senior engineers, provide customer updates&quot;</span><span class="p">,</span>
        <span class="n">confidence</span><span class="o">=</span><span class="mf">0.9</span>
    <span class="p">),</span>
    <span class="c1"># ... more decision scenarios</span>
<span class="p">]</span>

<span class="c1"># Optimize decision making</span>
<span class="n">mipro_optimizer</span> <span class="o">=</span> <span class="n">MIPRO</span><span class="p">(</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">decision_quality_metric</span><span class="p">,</span>
    <span class="n">num_candidates</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
<span class="n">optimized_agent</span> <span class="o">=</span> <span class="n">mipro_optimizer</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">OptimizedDecisionAgent</span><span class="p">(</span><span class="s2">&quot;Customer Support System&quot;</span><span class="p">),</span>
    <span class="n">trainset</span><span class="o">=</span><span class="n">decision_trainset</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices-for-building-agents">
<h2>Best Practices for Building Agents<a class="headerlink" href="#best-practices-for-building-agents" title="Link to this heading">#</a></h2>
<section id="clear-goal-definition">
<h3>1. Clear Goal Definition<a class="headerlink" href="#clear-goal-definition" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">GoalOrientedAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primary_goal</span><span class="p">,</span> <span class="n">sub_goals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primary_goal</span> <span class="o">=</span> <span class="n">primary_goal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sub_goals</span> <span class="o">=</span> <span class="n">sub_goals</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_alignment</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span>
            <span class="s2">&quot;action, goal -&gt; alignment_score, alignment_reason&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_goal_aligned</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if action aligns with goals.&quot;&quot;&quot;</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_alignment</span><span class="p">(</span>
            <span class="n">action</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">),</span>
            <span class="n">goal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">primary_goal</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">evaluation</span><span class="o">.</span><span class="n">alignment_score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.7</span>
</pre></div>
</div>
</section>
<section id="robust-error-handling">
<h3>2. Robust Error Handling<a class="headerlink" href="#robust-error-handling" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ResilientAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handle_error</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">Predict</span><span class="p">(</span><span class="s2">&quot;error, context -&gt; recovery_action&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fallback_responses</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;I&#39;m having trouble processing that. Could you rephrase?&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Let me try a different approach.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;I need more information to help with that.&quot;</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">safe_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute action with error handling.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">action_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Handle error gracefully</span>
            <span class="n">recovery</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span>
                <span class="n">error</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="n">context</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="s2">&quot;recovery_action&quot;</span><span class="p">:</span> <span class="n">recovery</span><span class="o">.</span><span class="n">recovery_action</span>
            <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="continuous-learning">
<h3>3. Continuous Learning<a class="headerlink" href="#continuous-learning" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AdaptiveAgent</span><span class="p">(</span><span class="n">dspy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learn_from_feedback</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">ChainOfThought</span><span class="p">(</span>
            <span class="s2">&quot;action, outcome, feedback -&gt; learning_insight, strategy_adjustment&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success_patterns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failure_patterns</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">feedback</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Learn from feedback on actions.&quot;&quot;&quot;</span>
        <span class="n">learning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learn_from_feedback</span><span class="p">(</span>
            <span class="n">action</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">),</span>
            <span class="n">outcome</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span>
            <span class="n">feedback</span><span class="o">=</span><span class="n">feedback</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;success&quot;</span> <span class="ow">in</span> <span class="n">feedback</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">success_patterns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learning</span><span class="o">.</span><span class="n">learning_insight</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failure_patterns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learning</span><span class="o">.</span><span class="n">learning_insight</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">learning</span>
</pre></div>
</div>
</section>
</section>
<section id="key-takeaways">
<h2>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Intelligent agents combine</strong> perception, planning, and action</p></li>
<li><p><strong>Different agent types</strong> suit different use cases and requirements</p></li>
<li><p><strong>Memory and learning</strong> are crucial for agent effectiveness</p></li>
<li><p><strong>Real-world agents</strong> must handle uncertainty, errors, and feedback</p></li>
<li><p><strong>Optimization improves</strong> decision-making and problem-solving</p></li>
<li><p><strong>Collaboration enables</strong> agents to tackle complex tasks together</p></li>
</ol>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h2>
<p>In the final section of this chapter, well explore <strong>Code Generation</strong>, showing how to build automated programming assistants that can help developers write, debug, and optimize code.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/06_real_world_applications"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="04_entity_extraction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Entity Extraction: Mining Structured Information from Text</p>
      </div>
    </a>
    <a class="right-next"
       href="06_code_generation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Code Generation: Building Automated Programming Assistants</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-intelligent-agents">Understanding Intelligent Agents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#core-components-of-an-agent">Core Components of an Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agent-types">Agent Types</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-intelligent-agents-with-dspy">Building Intelligent Agents with DSPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-reactive-agent">Basic Reactive Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proactive-agent-with-planning">Proactive Agent with Planning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collaborative-agent">Collaborative Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-agent">Learning Agent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#real-world-agent-applications">Real-World Agent Applications</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customer-service-agent">Customer Service Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#research-assistant-agent">Research Assistant Agent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#personal-finance-agent">Personal Finance Agent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-agent-behavior">Optimizing Agent Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mipro-for-agent-decision-making">Using MIPRO for Agent Decision Making</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practices-for-building-agents">Best Practices for Building Agents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clear-goal-definition">1. Clear Goal Definition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-error-handling">2. Robust Error Handling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-learning">3. Continuous Learning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaways">Key Takeaways</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dustin Ober
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>