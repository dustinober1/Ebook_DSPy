<svg viewBox="0 0 1000 700" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="500" y="35" font-size="22" font-weight="bold" text-anchor="middle" fill="#333">
    DSPy Optimization Workflow
  </text>

  <!-- Phase 1: Preparation -->
  <g>
    <text x="500" y="75" font-size="14" font-weight="bold" text-anchor="middle" fill="#5e35b1">
      Phase 1: Preparation
    </text>

    <!-- Data -->
    <rect x="80" y="100" width="180" height="80" fill="#f3e5f5" stroke="#7e57c2" stroke-width="2" rx="5"/>
    <text x="170" y="130" font-size="11" font-weight="bold" text-anchor="middle" fill="#5e35b1">
      Training Data
    </text>
    <text x="170" y="155" font-size="9" text-anchor="middle" fill="#333">
      Examples + labels
    </text>

    <!-- Metric -->
    <rect x="340" y="100" width="180" height="80" fill="#f3e5f5" stroke="#7e57c2" stroke-width="2" rx="5"/>
    <text x="430" y="130" font-size="11" font-weight="bold" text-anchor="middle" fill="#5e35b1">
      Evaluation Metric
    </text>
    <text x="430" y="155" font-size="9" text-anchor="middle" fill="#333">
      Measure correctness
    </text>

    <!-- Program -->
    <rect x="600" y="100" width="180" height="80" fill="#f3e5f5" stroke="#7e57c2" stroke-width="2" rx="5"/>
    <text x="690" y="130" font-size="11" font-weight="bold" text-anchor="middle" fill="#5e35b1">
      Initial Program
    </text>
    <text x="690" y="155" font-size="9" text-anchor="middle" fill="#333">
      With basic prompts
    </text>
  </g>

  <!-- Arrows down -->
  <line x1="170" y1="180" x2="170" y2="220" stroke="#999" stroke-width="1.5"/>
  <line x1="430" y1="180" x2="430" y2="220" stroke="#999" stroke-width="1.5"/>
  <line x1="690" y1="180" x2="690" y2="220" stroke="#999" stroke-width="1.5"/>

  <!-- Phase 2: Baseline Evaluation -->
  <g>
    <text x="500" y="245" font-size="14" font-weight="bold" text-anchor="middle" fill="#1565c0">
      Phase 2: Baseline Evaluation
    </text>

    <rect x="200" y="270" width="600" height="80" fill="#bbdefb" stroke="#1565c0" stroke-width="2" rx="5"/>
    <text x="500" y="300" font-size="11" font-weight="bold" text-anchor="middle" fill="#0d47a1">
      Evaluate initial program on training data
    </text>
    <text x="500" y="325" font-size="10" text-anchor="middle" fill="#333">
      Baseline Score: 65% accuracy (example)
    </text>
  </g>

  <!-- Arrow down -->
  <line x1="500" y1="350" x2="500" y2="380" stroke="#999" stroke-width="1.5"/>

  <!-- Phase 3: Choose Optimizer -->
  <g>
    <text x="500" y="405" font-size="14" font-weight="bold" text-anchor="middle" fill="#c62828">
      Phase 3: Choose Optimizer Strategy
    </text>

    <!-- BootstrapFewShot -->
    <rect x="50" y="430" width="160" height="100" fill="#ffebee" stroke="#d32f2f" stroke-width="1.5" rx="5"/>
    <text x="130" y="455" font-size="10" font-weight="bold" text-anchor="middle" fill="#b71c1c">
      BootstrapFewShot
    </text>
    <text x="130" y="475" font-size="8" text-anchor="middle" fill="#333">Find good examples</text>
    <text x="130" y="490" font-size="8" text-anchor="middle" fill="#333">automatically</text>
    <text x="130" y="510" font-size="8" text-anchor="middle" fill="#666" font-style="italic">Fast, data-driven</text>

    <!-- MIPRO -->
    <rect x="260" y="430" width="160" height="100" fill="#ffebee" stroke="#d32f2f" stroke-width="1.5" rx="5"/>
    <text x="340" y="455" font-size="10" font-weight="bold" text-anchor="middle" fill="#b71c1c">
      MIPRO
    </text>
    <text x="340" y="475" font-size="8" text-anchor="middle" fill="#333">Optimize instructions</text>
    <text x="340" y="490" font-size="8" text-anchor="middle" fill="#333">+ demonstrations</text>
    <text x="340" y="510" font-size="8" text-anchor="middle" fill="#666" font-style="italic">Powerful, flexible</text>

    <!-- KNNFewShot -->
    <rect x="470" y="430" width="160" height="100" fill="#ffebee" stroke="#d32f2f" stroke-width="1.5" rx="5"/>
    <text x="550" y="455" font-size="10" font-weight="bold" text-anchor="middle" fill="#b71c1c">
      KNNFewShot
    </text>
    <text x="550" y="475" font-size="8" text-anchor="middle" fill="#333">Select similar</text>
    <text x="550" y="490" font-size="8" text-anchor="middle" fill="#333">examples</text>
    <text x="550" y="510" font-size="8" text-anchor="middle" fill="#666" font-style="italic">Similarity-based</text>

    <!-- FineTuning -->
    <rect x="680" y="430" width="160" height="100" fill="#ffebee" stroke="#d32f2f" stroke-width="1.5" rx="5"/>
    <text x="760" y="455" font-size="10" font-weight="bold" text-anchor="middle" fill="#b71c1c">
      Fine-Tuning
    </text>
    <text x="760" y="475" font-size="8" text-anchor="middle" fill="#333">Train small LM</text>
    <text x="760" y="490" font-size="8" text-anchor="middle" fill="#333">on examples</text>
    <text x="760" y="510" font-size="8" text-anchor="middle" fill="#666" font-style="italic">Most expensive</text>
  </g>

  <!-- Arrow down -->
  <line x1="500" y1="530" x2="500" y2="560" stroke="#999" stroke-width="1.5"/>

  <!-- Phase 4: Compilation -->
  <g>
    <text x="500" y="585" font-size="14" font-weight="bold" text-anchor="middle" fill="#f57c00">
      Phase 4: Run Compilation
    </text>

    <rect x="200" y="610" width="600" height="80" fill="#ffe0b2" stroke="#f57c00" stroke-width="2" rx="5"/>
    <text x="500" y="640" font-size="11" font-weight="bold" text-anchor="middle" fill="#e65100">
      Optimizer runs on training data, generates prompts/examples
    </text>
    <text x="500" y="665" font-size="10" text-anchor="middle" fill="#333">
      Process: Test variations → Keep best → Repeat until convergence
    </text>
  </g>

  <!-- Right side: Results -->
  <g>
    <text x="850" y="405" font-size="14" font-weight="bold" text-anchor="middle" fill="#00796b">
      Results Achieved
    </text>

    <!-- Score improvement -->
    <rect x="750" y="430" width="200" height="70" fill="#e0f2f1" stroke="#00796b" stroke-width="2" rx="5"/>
    <text x="850" y="455" font-size="10" font-weight="bold" text-anchor="middle" fill="#00695c">
      Performance
    </text>
    <text x="850" y="475" font-size="10" text-anchor="middle" fill="#333">
      65% → 89% accuracy
    </text>

    <!-- Optimized prompts -->
    <rect x="750" y="520" width="200" height="70" fill="#e0f2f1" stroke="#00796b" stroke-width="2" rx="5"/>
    <text x="850" y="545" font-size="10" font-weight="bold" text-anchor="middle" fill="#00695c">
      Optimized Prompts
    </text>
    <text x="850" y="565" font-size="9" text-anchor="middle" fill="#333">
      Better instructions
    </text>

    <!-- In-context examples -->
    <rect x="750" y="610" width="200" height="70" fill="#e0f2f1" stroke="#00796b" stroke-width="2" rx="5"/>
    <text x="850" y="635" font-size="10" font-weight="bold" text-anchor="middle" fill="#00695c">
      In-Context Examples
    </text>
    <text x="850" y="655" font-size="9" text-anchor="middle" fill="#333">
      Automatic demos
    </text>
  </g>

  <!-- Arrows from compilation to results -->
  <line x1="800" y1="630" x2="800" y2="480" stroke="#999" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="800" y1="630" x2="800" y2="570" stroke="#999" stroke-width="1.5" stroke-dasharray="5,5"/>
  <line x1="800" y1="630" x2="800" y2="660" stroke="#999" stroke-width="1.5" stroke-dasharray="5,5"/>
</svg>
