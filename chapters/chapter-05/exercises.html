<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercises | Chapter 5 | DSPy: The Comprehensive Guide</title>
    <meta name="description"
        content="Practice building RAG systems with hands-on exercises - retrievers, pipelines, and advanced patterns.">
    <link rel="stylesheet" href="../../assets/css/style.css?v=2">
    <link rel="stylesheet" href="../../assets/css/chapter.css?v=8">
    <link rel="stylesheet" href="../../assets/css/content.css?v=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>

<body class="chapter-page">
    <header>
        <div class="logo">
            <a href="../../index.html">
                <img src="../../src/assets/logos/logo.png" alt="DSPy Ebook Logo">
                <span>DSPy Ebook</span>
            </a>
        </div>
        <nav>
            <ul>
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../index.html#chapters">Chapters</a></li>
                <li><a href="https://github.com/dustinober1/Ebook_DSPy" target="_blank">GitHub</a></li>
            </ul>
        </nav>
    </header>

    <div class="chapter-layout">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Chapter 5</h2>
                <span class="sidebar-subtitle">Retrieval</span>
            </div>
            <nav class="sidebar-nav">
                <ul class="section-list" id="section-list">
                    <li class="section-item viewed" data-section="intro">
                        <a href="index.html">
                            <span class="section-number">1</span>
                            <span class="section-title">Chapter Overview</span>
                        </a>
                    </li>
                    <li class="section-item viewed" data-section="what-is-rag">
                        <a href="what-is-rag.html">
                            <span class="section-number">2</span>
                            <span class="section-title">What is RAG?</span>
                        </a>
                    </li>
                    <li class="section-item viewed" data-section="retrievers">
                        <a href="retrievers.html">
                            <span class="section-number">3</span>
                            <span class="section-title">Retriever Modules</span>
                        </a>
                    </li>
                    <li class="section-item viewed" data-section="rag-pipelines">
                        <a href="rag-pipelines.html">
                            <span class="section-number">4</span>
                            <span class="section-title">Building RAG Pipelines</span>
                        </a>
                    </li>
                    <li class="section-item viewed" data-section="advanced-rag">
                        <a href="advanced-rag.html">
                            <span class="section-number">5</span>
                            <span class="section-title">Advanced RAG Patterns</span>
                        </a>
                    </li>
                    <li class="section-item active" data-section="exercises">
                        <a href="exercises.html">
                            <span class="section-number">6</span>
                            <span class="section-title">Exercises</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="solutions">
                        <a href="solutions.html">
                            <span class="section-number">7</span>
                            <span class="section-title">Solutions</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="../chapter-06/index.html" class="next-chapter-btn">
                    Next: Chapter 06 ‚Üí
                </a>
            </div>
        </aside>

        <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle Sidebar">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <main class="chapter-content">
            <div class="reading-progress" id="reading-progress">
                <div class="progress-bar"></div>
            </div>

            <section class="chapter-hero">
                <div class="chapter-hero-content is-visible fade-in-up">
                    <span class="chapter-label">Chapter 5 ¬∑ Section 6</span>
                    <h1 class="chapter-title">Exercises</h1>
                    <p class="chapter-description">Build RAG systems from scratch with these hands-on exercises.</p>
                    <div class="chapter-meta">
                        <span class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            5 Exercises
                        </span>
                        <span class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            ~1-2 hours
                        </span>
                    </div>
                </div>
            </section>

            <div class="content-wrapper">
                <article class="content-article" id="content-article">
                    <section class="content-section is-visible" id="exercises" data-section="exercises">
                        <div class="markdown-content" id="exercises-content">

                            <!-- Introduction -->
                            <div class="content-block">
                                <h2>üèãÔ∏è Build RAG Systems</h2>

                                <p>These exercises progress from basic retrieval to complete RAG applications.</p>

                                <div class="tip-box">
                                    <span class="tip-icon">üí°</span>
                                    <p><strong>Setup:</strong> For exercises using ChromaDB, install with:
                                        <code>pip install chromadb</code>
                                    </p>
                                </div>
                            </div>

                            <!-- Exercise 1 -->
                            <div class="content-block exercise-block">
                                <div class="exercise-header">
                                    <span class="exercise-number">Exercise 1</span>
                                    <span class="difficulty beginner">‚≠ê Beginner</span>
                                </div>
                                <h3>Build a Simple Retriever</h3>

                                <p><strong>Task:</strong> Create an in-memory retriever using TF-IDF.</p>

                                <p><strong>Requirements:</strong></p>
                                <ul>
                                    <li>Create a <code>SimpleRetriever</code> class that takes a list of documents</li>
                                    <li>Use TF-IDF vectorization (sklearn)</li>
                                    <li>Implement a <code>__call__</code> method that returns top-k documents</li>
                                    <li>Test with at least 10 sample documents</li>
                                </ul>

                                <p><strong>Test your retriever:</strong></p>
                                <div class="command-box">
                                    <pre><code class="language-python">docs = [
    "Python is a programming language",
    "DSPy is a framework for LMs",
    "Machine learning uses data",
    # ... more docs
]

retriever = SimpleRetriever(docs)
results = retriever("What is DSPy?", k=3)
print(results)  # Should return DSPy-related docs first</code></pre>
                                </div>
                            </div>

                            <!-- Exercise 2 -->
                            <div class="content-block exercise-block">
                                <div class="exercise-header">
                                    <span class="exercise-number">Exercise 2</span>
                                    <span class="difficulty beginner">‚≠ê Beginner</span>
                                </div>
                                <h3>Basic RAG Pipeline</h3>

                                <p><strong>Task:</strong> Build a complete RAG module using your retriever.</p>

                                <p><strong>Requirements:</strong></p>
                                <ul>
                                    <li>Create a RAG module with retrieve and generate steps</li>
                                    <li>Use <code>dspy.ChainOfThought</code> for generation</li>
                                    <li>Return both the answer and the retrieved context</li>
                                    <li>Test on at least 3 different questions</li>
                                </ul>

                                <p><strong>Knowledge base to use:</strong></p>
                                <div class="command-box">
                                    <pre><code class="language-python">knowledge_base = [
    "DSPy is a framework for programming language models.",
    "Signatures in DSPy define inputs and outputs.",
    "Modules like Predict and ChainOfThought execute signatures.",
    "Optimizers like BootstrapFewShot improve DSPy programs.",
    "RAG retrieves relevant documents before generation.",
]</code></pre>
                                </div>
                            </div>

                            <!-- Exercise 3 -->
                            <div class="content-block exercise-block">
                                <div class="exercise-header">
                                    <span class="exercise-number">Exercise 3</span>
                                    <span class="difficulty intermediate">‚≠ê‚≠ê Intermediate</span>
                                </div>
                                <h3>RAG with Citations</h3>

                                <p><strong>Task:</strong> Add citation capabilities to your RAG system.</p>

                                <p><strong>Requirements:</strong></p>
                                <ul>
                                    <li>Number retrieved passages as [1], [2], etc.</li>
                                    <li>Create a signature that generates answers with citation references</li>
                                    <li>Parse and validate that citations reference actual passages</li>
                                    <li>Return the answer, citations used, and the source passages</li>
                                </ul>

                                <p><strong>Expected output format:</strong></p>
                                <div class="command-box">
                                    <pre><code class="language-python">{
    "answer": "DSPy is a framework for programming LMs [1].",
    "sources_used": ["1"],
    "passages": {"1": "DSPy is a framework..."}
}</code></pre>
                                </div>
                            </div>

                            <!-- Exercise 4 -->
                            <div class="content-block exercise-block">
                                <div class="exercise-header">
                                    <span class="exercise-number">Exercise 4</span>
                                    <span class="difficulty intermediate">‚≠ê‚≠ê Intermediate</span>
                                </div>
                                <h3>Query Expansion RAG</h3>

                                <p><strong>Task:</strong> Improve retrieval by expanding the user's query.</p>

                                <p><strong>Requirements:</strong></p>
                                <ul>
                                    <li>Create a query expansion module that generates 3 related queries</li>
                                    <li>Retrieve documents for all queries</li>
                                    <li>Deduplicate and rank the combined results</li>
                                    <li>Use the expanded context for generation</li>
                                </ul>

                                <p><strong>Example:</strong></p>
                                <div class="command-box">
                                    <pre><code class="language-python"># Original: "How does DSPy work?"
# Expanded: 
#   - "How does DSPy work?"
#   - "DSPy architecture and components"
#   - "DSPy programming model explanation"</code></pre>
                                </div>
                            </div>

                            <!-- Exercise 5 -->
                            <div class="content-block exercise-block">
                                <div class="exercise-header">
                                    <span class="exercise-number">Exercise 5</span>
                                    <span class="difficulty advanced">‚≠ê‚≠ê‚≠ê Advanced</span>
                                </div>
                                <h3>Multi-Hop RAG System</h3>

                                <p><strong>Task:</strong> Build a multi-hop RAG for complex questions.</p>

                                <p><strong>Requirements:</strong></p>

                                <div class="chapter-sections-list">
                                    <div class="chapter-section-item">
                                        <span class="section-icon">1Ô∏è‚É£</span>
                                        <div class="section-content">
                                            <h4>Knowledge Base</h4>
                                            <p>Create 15+ documents with interconnected facts</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">2Ô∏è‚É£</span>
                                        <div class="section-content">
                                            <h4>Multi-Hop Module</h4>
                                            <p>Implement iterative retrieval with query generation</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">3Ô∏è‚É£</span>
                                        <div class="section-content">
                                            <h4>Test Questions</h4>
                                            <p>Create questions requiring 2+ hops to answer</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">4Ô∏è‚É£</span>
                                        <div class="section-content">
                                            <h4>Evaluation</h4>
                                            <p>Compare single-hop vs multi-hop accuracy</p>
                                        </div>
                                    </div>
                                </div>

                                <p><strong>Sample multi-hop question:</strong></p>
                                <div class="command-box">
                                    <pre><code class="language-text">"What optimization technique does the framework
created by Stanford's NLP group use?"

Required hops:
1. Stanford NLP ‚Üí DSPy
2. DSPy ‚Üí BootstrapFewShot optimizer</code></pre>
                                </div>
                            </div>

                            <!-- Tips -->
                            <div class="content-block">
                                <h2>üí° Exercise Tips</h2>

                                <div class="chapter-sections-list">
                                    <div class="chapter-section-item">
                                        <span class="section-icon">üß™</span>
                                        <div class="section-content">
                                            <h4>Test Retrieval First</h4>
                                            <p>Verify your retriever returns relevant docs before adding generation</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">üìè</span>
                                        <div class="section-content">
                                            <h4>Start with Small k</h4>
                                            <p>Use k=3 initially, increase if needed for more context</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">üîç</span>
                                        <div class="section-content">
                                            <h4>Print Intermediate Steps</h4>
                                            <p>Log retrieved docs and queries to debug issues</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">üìä</span>
                                        <div class="section-content">
                                            <h4>Measure Quality</h4>
                                            <p>Check if answers actually use the retrieved context</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Continue -->
                            <div class="content-block">
                                <div class="success-content">
                                    <span class="success-icon-large">üéâ</span>
                                    <h2>Ready to Compare?</h2>
                                    <p>Check your solutions against ours!</p>
                                </div>
                                <div class="continue-btn-container">
                                    <a href="solutions.html" class="continue-btn">
                                        <span>View Solutions</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M5 12h14M12 5l7 7-7 7" />
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </section>
                </article>
            </div>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 DSPy Ebook. All rights reserved.</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="../../assets/js/main.js?v=1"></script>
    <script src="../../assets/js/chapter_v2.js" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (window.initChapter) {
                window.initChapter({});
            }
            setTimeout(() => {
                if (window.Prism) window.Prism.highlightAll();
            }, 100);
        });
    </script>
</body>

</html>