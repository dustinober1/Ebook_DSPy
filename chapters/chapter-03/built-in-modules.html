<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Built-in Modules | Chapter 3 | DSPy: The Comprehensive Guide</title>
    <meta name="description"
        content="Master all DSPy built-in modules - Predict, ChainOfThought, ProgramOfThought, ReAct, and more.">
    <link rel="stylesheet" href="../../assets/css/style.css?v=2">
    <link rel="stylesheet" href="../../assets/css/chapter.css?v=8">
    <link rel="stylesheet" href="../../assets/css/content.css?v=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>

<body class="chapter-page">
    <header>
        <div class="logo">
            <a href="../../index.html">
                <img src="../../src/assets/logos/logo.png" alt="DSPy Ebook Logo">
                <span>DSPy Ebook</span>
            </a>
        </div>
        <nav>
            <ul>
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../index.html#chapters">Chapters</a></li>
                <li><a href="https://github.com/dustinober1/Ebook_DSPy" target="_blank">GitHub</a></li>
            </ul>
        </nav>
    </header>

    <div class="chapter-layout">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Chapter 3</h2>
                <span class="sidebar-subtitle">Modules</span>
            </div>
            <nav class="sidebar-nav">
                <ul class="section-list" id="section-list">
                    <li class="section-item viewed" data-section="intro">
                        <a href="index.html">
                            <span class="section-number">1</span>
                            <span class="section-title">Chapter Overview</span>
                        </a>
                    </li>
                    <li class="section-item viewed" data-section="what-are-modules">
                        <a href="what-are-modules.html">
                            <span class="section-number">2</span>
                            <span class="section-title">What Are Modules?</span>
                        </a>
                    </li>
                    <li class="section-item active" data-section="built-in-modules">
                        <a href="built-in-modules.html">
                            <span class="section-number">3</span>
                            <span class="section-title">Built-in Modules</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="custom-modules">
                        <a href="custom-modules.html">
                            <span class="section-number">4</span>
                            <span class="section-title">Creating Custom Modules</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="module-composition">
                        <a href="module-composition.html">
                            <span class="section-number">5</span>
                            <span class="section-title">Module Composition</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="exercises">
                        <a href="exercises.html">
                            <span class="section-number">6</span>
                            <span class="section-title">Exercises</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="solutions">
                        <a href="solutions.html">
                            <span class="section-number">7</span>
                            <span class="section-title">Solutions</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="../chapter-04/index.html" class="next-chapter-btn">
                    Next: Chapter 04 ‚Üí
                </a>
            </div>
        </aside>

        <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle Sidebar">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <main class="chapter-content">
            <div class="reading-progress" id="reading-progress">
                <div class="progress-bar"></div>
            </div>

            <section class="chapter-hero">
                <div class="chapter-hero-content is-visible fade-in-up">
                    <span class="chapter-label">Chapter 3 ¬∑ Section 3</span>
                    <h1 class="chapter-title">Built-in Modules</h1>
                    <p class="chapter-description">DSPy provides several powerful built-in modules, each adding unique
                        capabilities to your LM applications.</p>
                    <div class="chapter-meta">
                        <span class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            ~20 min read
                        </span>
                    </div>
                </div>
            </section>

            <div class="content-wrapper">
                <article class="content-article" id="content-article">
                    <section class="content-section is-visible" id="built-in-modules" data-section="built-in-modules">
                        <div class="markdown-content" id="built-in-modules-content">

                            <!-- Predict -->
                            <div class="content-block">
                                <h2>‚ö° dspy.Predict</h2>

                                <p>The simplest module‚Äîmakes a single LM call based on your signature.</p>

                                <div class="command-box">
                                    <pre><code class="language-python">import dspy

class Translate(dspy.Signature):
    """Translate the text to the target language."""
    text: str = dspy.InputField()
    language: str = dspy.InputField()
    translation: str = dspy.OutputField()

# Create and use
translator = dspy.Predict(Translate)
result = translator(text="Hello, world!", language="Spanish")
print(result.translation)  # ¬°Hola, mundo!</code></pre>
                                </div>

                                <div class="chapter-sections-list">
                                    <div class="chapter-section-item">
                                        <span class="section-icon">‚úÖ</span>
                                        <div class="section-content">
                                            <h4>When to Use</h4>
                                            <p>Simple, straightforward tasks where reasoning isn't needed. Translation,
                                                classification, simple Q&A.</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">‚ö†Ô∏è</span>
                                        <div class="section-content">
                                            <h4>Limitations</h4>
                                            <p>May struggle with complex reasoning, multi-step problems, or math.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ChainOfThought -->
                            <div class="content-block">
                                <h2>üí≠ dspy.ChainOfThought</h2>

                                <p>Automatically adds a "reasoning" step before generating the final answer. This
                                    dramatically improves accuracy on complex tasks.</p>

                                <div class="command-box">
                                    <pre><code class="language-python">class MathProblem(dspy.Signature):
    """Solve the math word problem."""
    problem: str = dspy.InputField()
    answer: str = dspy.OutputField()

# ChainOfThought adds reasoning automatically
solver = dspy.ChainOfThought(MathProblem)

result = solver(problem="""
A train travels 120 miles at 60 mph, then 80 miles at 40 mph.
What is the total time for the journey?
""")

# Access the reasoning
print(f"Reasoning: {result.rationale}")
# First leg: 120 miles √∑ 60 mph = 2 hours
# Second leg: 80 miles √∑ 40 mph = 2 hours
# Total: 2 + 2 = 4 hours

print(f"Answer: {result.answer}")  # 4 hours</code></pre>
                                </div>

                                <div class="tip-box">
                                    <span class="tip-icon">üí°</span>
                                    <p><strong>Key feature:</strong> ChainOfThought automatically adds a
                                        <code>rationale</code> output field‚Äîyou don't need to define it in your
                                        signature!
                                    </p>
                                </div>

                                <div class="chapter-sections-list">
                                    <div class="chapter-section-item">
                                        <span class="section-icon">‚úÖ</span>
                                        <div class="section-content">
                                            <h4>When to Use</h4>
                                            <p>Complex reasoning, math problems, multi-step analysis, decision-making.
                                            </p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">üìà</span>
                                        <div class="section-content">
                                            <h4>Performance</h4>
                                            <p>Often 20-40% more accurate than Predict on reasoning tasks, but uses more
                                                tokens.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ChainOfThoughtWithHint -->
                            <div class="content-block">
                                <h2>üí° dspy.ChainOfThoughtWithHint</h2>

                                <p>Like ChainOfThought, but accepts a hint to guide the reasoning process.</p>

                                <div class="command-box">
                                    <pre><code class="language-python">class ComplexAnalysis(dspy.Signature):
    """Analyze the situation and provide recommendations."""
    situation: str = dspy.InputField()
    recommendation: str = dspy.OutputField()

# Create with hint capability
analyzer = dspy.ChainOfThoughtWithHint(ComplexAnalysis)

result = analyzer(
    situation="Our startup is growing fast but running low on runway.",
    hint="Consider both short-term survival and long-term growth options."
)

print(result.rationale)      # Shows reasoning influenced by hint
print(result.recommendation)</code></pre>
                                </div>

                                <div class="chapter-sections-list">
                                    <div class="chapter-section-item">
                                        <span class="section-icon">‚úÖ</span>
                                        <div class="section-content">
                                            <h4>When to Use</h4>
                                            <p>When you want to guide the LM's reasoning direction without fully
                                                specifying the approach.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ProgramOfThought -->
                            <div class="content-block">
                                <h2>üíª dspy.ProgramOfThought</h2>

                                <p>Generates Python code to solve the problem, then executes it for precise
                                    calculations.</p>

                                <div class="command-box">
                                    <pre><code class="language-python">class Calculation(dspy.Signature):
    """Calculate the result."""
    problem: str = dspy.InputField()
    answer: float = dspy.OutputField()

# ProgramOfThought generates and runs code
calculator = dspy.ProgramOfThought(Calculation)

result = calculator(problem="""
Calculate compound interest on $10,000 at 5% annual rate 
compounded monthly for 3 years.
""")

print(result.answer)  # 11,614.72 (precise calculation)</code></pre>
                                </div>

                                <div class="tip-box">
                                    <span class="tip-icon">‚ö†Ô∏è</span>
                                    <p><strong>Security note:</strong> ProgramOfThought executes generated code. Use
                                        with caution and only with trusted inputs.</p>
                                </div>

                                <div class="chapter-sections-list">
                                    <div class="chapter-section-item">
                                        <span class="section-icon">‚úÖ</span>
                                        <div class="section-content">
                                            <h4>When to Use</h4>
                                            <p>Mathematical calculations, data processing, algorithmic problems where
                                                precision matters.</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">üìä</span>
                                        <div class="section-content">
                                            <h4>Advantage</h4>
                                            <p>100% accurate for calculations (no LM hallucination on the math
                                                itself).</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ReAct -->
                            <div class="content-block">
                                <h2>üõ†Ô∏è dspy.ReAct</h2>

                                <p>Implements the ReAct (Reasoning + Acting) pattern‚Äîthe LM can use tools and observe
                                    results in a loop.</p>

                                <div class="command-box">
                                    <pre><code class="language-python">import dspy

# Define tools the agent can use
def search_web(query: str) -> str:
    """Search the web for information."""
    # In reality, call a search API
    return f"Search results for: {query}"

def calculate(expression: str) -> str:
    """Evaluate a mathematical expression."""
    return str(eval(expression))

# Create ReAct agent with tools
class ResearchTask(dspy.Signature):
    """Research the topic and provide a comprehensive answer."""
    question: str = dspy.InputField()
    answer: str = dspy.OutputField()

researcher = dspy.ReAct(
    ResearchTask,
    tools=[search_web, calculate]
)

result = researcher(question="What is the population of Tokyo and how does it compare to New York?")
print(result.answer)</code></pre>
                                </div>

                                <div class="chapter-sections-list">
                                    <div class="chapter-section-item">
                                        <span class="section-icon">üîÑ</span>
                                        <div class="section-content">
                                            <h4>How It Works</h4>
                                            <p>The LM reasons about what to do ‚Üí calls a tool ‚Üí observes the result ‚Üí
                                                reasons again ‚Üí repeats until done.</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <span class="section-icon">‚úÖ</span>
                                        <div class="section-content">
                                            <h4>When to Use</h4>
                                            <p>Tasks requiring external information, API calls, web search, database
                                                queries, or multi-step tool use.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Comparison Chart -->
                            <div class="content-block">
                                <h2>üìä Module Comparison</h2>

                                <div class="module-comparison">
                                    <table class="styled-table">
                                        <thead>
                                            <tr>
                                                <th>Module</th>
                                                <th>LM Calls</th>
                                                <th>Reasoning</th>
                                                <th>Tools</th>
                                                <th>Token Usage</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><code>Predict</code></td>
                                                <td>1</td>
                                                <td>‚ùå</td>
                                                <td>‚ùå</td>
                                                <td>Low</td>
                                            </tr>
                                            <tr>
                                                <td><code>ChainOfThought</code></td>
                                                <td>1</td>
                                                <td>‚úÖ</td>
                                                <td>‚ùå</td>
                                                <td>Medium</td>
                                            </tr>
                                            <tr>
                                                <td><code>ProgramOfThought</code></td>
                                                <td>1+</td>
                                                <td>‚úÖ (via code)</td>
                                                <td>‚ùå</td>
                                                <td>Medium</td>
                                            </tr>
                                            <tr>
                                                <td><code>ReAct</code></td>
                                                <td>Multiple</td>
                                                <td>‚úÖ</td>
                                                <td>‚úÖ</td>
                                                <td>High</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Choosing the Right Module -->
                            <div class="content-block">
                                <h2>üéØ Choosing the Right Module</h2>

                                <div class="decision-tree">
                                    <div class="chapter-sections-list">
                                        <div class="chapter-section-item">
                                            <span class="section-icon">‚ùì</span>
                                            <div class="section-content">
                                                <h4>Is it a simple, direct task?</h4>
                                                <p>Use <code>dspy.Predict</code> ‚Äî fast and token-efficient.</p>
                                            </div>
                                        </div>
                                        <div class="chapter-section-item">
                                            <span class="section-icon">‚ùì</span>
                                            <div class="section-content">
                                                <h4>Does it require reasoning or analysis?</h4>
                                                <p>Use <code>dspy.ChainOfThought</code> ‚Äî shows its work.</p>
                                            </div>
                                        </div>
                                        <div class="chapter-section-item">
                                            <span class="section-icon">‚ùì</span>
                                            <div class="section-content">
                                                <h4>Does it involve precise calculations?</h4>
                                                <p>Use <code>dspy.ProgramOfThought</code> ‚Äî generates and runs code.</p>
                                            </div>
                                        </div>
                                        <div class="chapter-section-item">
                                            <span class="section-icon">‚ùì</span>
                                            <div class="section-content">
                                                <h4>Does it need external tools or data?</h4>
                                                <p>Use <code>dspy.ReAct</code> ‚Äî can search, call APIs, etc.</p>
                                            </div>
                                        </div>
                                        <div class="chapter-section-item">
                                            <span class="section-icon">‚ùì</span>
                                            <div class="section-content">
                                                <h4>Is it a complex multi-step workflow?</h4>
                                                <p>Create a custom <code>dspy.Module</code> ‚Äî next section!</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Practical Example -->
                            <div class="content-block">
                                <h2>üîß Practical Example: Same Task, Different Modules</h2>

                                <div class="command-box">
                                    <pre><code class="language-python">import dspy

# Configure LM
lm = dspy.LM("openai/gpt-4o-mini")
dspy.configure(lm=lm)

class AnalyzeReview(dspy.Signature):
    """Analyze a product review and determine if the customer would recommend it."""
    review: str = dspy.InputField()
    would_recommend: bool = dspy.OutputField()
    reasoning: str = dspy.OutputField()

# Test review
review = """
The laptop is beautiful and fast, but the battery only lasts 3 hours.
For the price, I expected better. The keyboard is great for typing though.
Customer service was helpful when I had questions.
"""

# Using Predict - quick but may miss nuance
simple = dspy.Predict(AnalyzeReview)
result1 = simple(review=review)
print(f"Predict: {result1.would_recommend}")

# Using ChainOfThought - considers all factors
smart = dspy.ChainOfThought(AnalyzeReview)
result2 = smart(review=review)
print(f"ChainOfThought: {result2.would_recommend}")
print(f"Rationale: {result2.rationale}")

# The CoT version will likely give a more nuanced, justified answer</code></pre>
                                </div>
                            </div>

                            <!-- Key Takeaways -->
                            <div class="content-block summary-block">
                                <h2>üìù Key Takeaways</h2>

                                <div class="chapter-sections-list no-icons">
                                    <div class="chapter-section-item">
                                        <div class="section-content">
                                            <p><strong>Predict</strong> ‚Äî Simple, fast, single LM call</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <div class="section-content">
                                            <p><strong>ChainOfThought</strong> ‚Äî Adds reasoning, much better for complex
                                                tasks</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <div class="section-content">
                                            <p><strong>ProgramOfThought</strong> ‚Äî Generates code for precise
                                                calculations</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <div class="section-content">
                                            <p><strong>ReAct</strong> ‚Äî Uses tools in reasoning loops for agentic
                                                tasks</p>
                                        </div>
                                    </div>
                                    <div class="chapter-section-item">
                                        <div class="section-content">
                                            <p><strong>Match the module to your task</strong> for best results</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Continue -->
                            <div class="content-block">
                                <div class="continue-btn-container">
                                    <a href="custom-modules.html" class="continue-btn">
                                        <span>Continue to Creating Custom Modules</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M5 12h14M12 5l7 7-7 7" />
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </section>
                </article>
            </div>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 DSPy Ebook. All rights reserved.</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="../../assets/js/main.js?v=1"></script>
    <script src="../../assets/js/chapter_v2.js" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (window.initChapter) {
                window.initChapter({});
            }
            setTimeout(() => {
                if (window.Prism) window.Prism.highlightAll();
            }, 100);
        });
    </script>
</body>

</html>