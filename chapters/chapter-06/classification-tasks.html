<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classification Tasks | Chapter 6 | DSPy: The Comprehensive Guide</title>
    <meta name="description"
        content="Learn to build robust text classification systems with DSPy, from binary and multi-class classifiers to hierarchical and confidence-aware models.">
    <link rel="stylesheet" href="../../assets/css/style.css?v=2">
    <link rel="stylesheet" href="../../assets/css/chapter.css?v=8">
    <link rel="stylesheet" href="../../assets/css/content.css?v=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>

<body class="chapter-page">
    <header>
        <div class="logo">
            <a href="../../index.html">
                <img src="../../src/assets/logos/logo.png" alt="DSPy Ebook Logo">
                <span>DSPy Ebook</span>
            </a>
        </div>
        <nav>
            <ul>
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../index.html#chapters">Chapters</a></li>
                <li><a href="https://github.com/dustinober1/Ebook_DSPy" target="_blank">GitHub</a></li>
            </ul>
        </nav>
    </header>

    <div class="chapter-layout">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Chapter 6</h2>
                <span class="sidebar-subtitle">Real-World Apps</span>
            </div>
            <nav class="sidebar-nav">
                <ul class="section-list" id="section-list">
                    <li class="section-item viewed" data-section="intro">
                        <a href="index.html">
                            <span class="section-number">1</span>
                            <span class="section-title">Chapter Overview</span>
                        </a>
                    </li>
                    <li class="section-item viewed" data-section="rag-systems">
                        <a href="rag-systems.html">
                            <span class="section-number">2</span>
                            <span class="section-title">RAG Systems</span>
                        </a>
                    </li>
                    <li class="section-item viewed" data-section="multi-hop-search">
                        <a href="multi-hop-search.html">
                            <span class="section-number">3</span>
                            <span class="section-title">Multi-hop Search</span>
                        </a>
                    </li>
                    <li class="section-item active" data-section="classification-tasks">
                        <a href="classification-tasks.html">
                            <span class="section-number">4</span>
                            <span class="section-title">Classification Tasks</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="entity-extraction">
                        <a href="entity-extraction.html">
                            <span class="section-number">5</span>
                            <span class="section-title">Entity Extraction</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="intelligent-agents">
                        <a href="intelligent-agents.html">
                            <span class="section-number">6</span>
                            <span class="section-title">Intelligent Agents</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="code-generation">
                        <a href="code-generation.html">
                            <span class="section-number">7</span>
                            <span class="section-title">Code Generation</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="exercises">
                        <a href="exercises.html">
                            <span class="section-number">8</span>
                            <span class="section-title">Exercises</span>
                        </a>
                    </li>
                    <li class="section-item" data-section="solutions">
                        <a href="solutions.html">
                            <span class="section-number">9</span>
                            <span class="section-title">Solutions</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="../chapter-07/index.html" class="next-chapter-btn">
                    Next: Chapter 07 →
                </a>
            </div>
        </aside>

        <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle Sidebar">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <main class="chapter-content">
            <div class="reading-progress" id="reading-progress">
                <div class="progress-bar"></div>
            </div>

            <section class="chapter-hero">
                <div class="chapter-hero-content is-visible fade-in-up">
                    <span class="chapter-label">Chapter 6 · Section 4</span>
                    <h1 class="chapter-title">Classification Tasks</h1>
                    <p class="chapter-description">Build robust systems for categorize text, from simple binary
                        classifiers to complex hierarchical models.</p>
                    <div class="chapter-meta">
                        <span class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            ~15 min read
                        </span>
                    </div>
                </div>
            </section>

            <div class="content-wrapper">
                <article class="content-article" id="content-article">
                    <section class="content-section is-visible" id="introduction" data-section="introduction">
                        <div class="markdown-content" id="introduction-content">
                            <!-- Introduction -->
                            <div class="content-block">
                                <h2>Introduction</h2>
                                <p>Text classification focuses on automatically assigning categories to text. It powers
                                    diverse applications ranging from spam detection to intent recognition. DSPy
                                    simplifies building sophisticated classifiers that handle the complexity and nuances
                                    of real-world data effectively.</p>
                            </div>

                            <!-- Understanding Text Classification -->
                            <div class="content-block">
                                <h2>Understanding Text Classification</h2>

                                <h3>Classification Types</h3>
                                <ul class="feature-list">
                                    <li><strong>Binary Classification:</strong> Two classes (e.g., spam vs. not spam,
                                        positive vs. negative).</li>
                                    <li><strong>Multi-class Classification:</strong> Multiple exclusive categories
                                        (e.g., news topics: sports, politics, tech).</li>
                                    <li><strong>Multi-label Classification:</strong> Multiple non-exclusive categories
                                        (e.g., tagging a blog post with "AI" and "Tutorial").</li>
                                    <li><strong>Hierarchical Classification:</strong> Nested categories (e.g., Product >
                                        Electronics > Smartphones).</li>
                                </ul>

                                <h3>Real-World Applications</h3>
                                <div class="example-box">
                                    <ul class="simple-list">
                                        <li><strong>Content Moderation:</strong> Detecting inappropriate or harmful
                                            content.</li>
                                        <li><strong>Customer Support:</strong> Routing tickets to appropriate
                                            departments (Billing, Tech Support).</li>
                                        <li><strong>Market Analysis:</strong> Categorizing news and sentiment in social
                                            media.</li>
                                        <li><strong>Intent Recognition:</strong> Understanding user goals in chatbots.
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Building Basic Classifiers -->
                            <div class="content-block">
                                <h2>Building Basic Classifiers</h2>

                                <h3>Simple Binary Classifier</h3>
                                <p>A basic module to classify text into two opposing categories:</p>

                                <div class="code-block">
                                    <div class="code-header">
                                        <span class="code-language">Python</span>
                                        <button class="copy-btn" aria-label="Copy code">Copy</button>
                                    </div>
                                    <pre><code class="language-python">import dspy

class BinaryClassifier(dspy.Module):
    def __init__(self, positive_class="positive", negative_class="negative"):
        super().__init__()
        self.positive_class = positive_class
        self.negative_class = negative_class
        self.classify = dspy.Predict("text -> classification, confidence")

    def forward(self, text):
        result = self.classify(text=text)

        # Normalize classification
        classification = result.classification.lower()
        if self.positive_class in classification:
            label = self.positive_class
        elif self.negative_class in classification:
            label = self.negative_class
        else:
            # Fallback based on confidence
            label = self.positive_class if float(result.confidence) > 0.5 else self.negative_class

        return dspy.Prediction(
            classification=label,
            confidence=result.confidence,
            raw_prediction=result.classification
        )</code></pre>
                                </div>

                                <h3>Multi-class Classifier</h3>
                                <p>For selecting one category from many:</p>

                                <div class="code-block">
                                    <div class="code-header">
                                        <span class="code-language">Python</span>
                                        <button class="copy-btn" aria-label="Copy code">Copy</button>
                                    </div>
                                    <pre><code class="language-python">class MultiClassClassifier(dspy.Module):
    def __init__(self, categories):
        super().__init__()
        self.categories = categories
        categories_str = ", ".join(categories)
        self.classify = dspy.Predict(
            f"text, categories[{categories_str}] -> classification, confidence, reasoning"
        )

    def forward(self, text):
        result = self.classify(text=text, categories=", ".join(self.categories))

        # Ensure classification is capable of matching a known category
        if result.classification not in self.categories:
             # Logic to find closest category match would go here
             pass

        return dspy.Prediction(
            classification=result.classification,
            confidence=result.confidence,
            reasoning=result.reasoning
        )</code></pre>
                                </div>
                            </div>

                            <!-- Advanced Classification Techniques -->
                            <div class="content-block">
                                <h2>Advanced Classification Techniques</h2>

                                <h3>Hierarchical Classification</h3>
                                <p>Classifying into a taxonomy level by level:</p>
                                <div class="code-block">
                                    <div class="code-header">
                                        <span class="code-language">Python</span>
                                        <button class="copy-btn" aria-label="Copy code">Copy</button>
                                    </div>
                                    <pre><code class="language-python">class HierarchicalClassifier(dspy.Module):
    def __init__(self, hierarchy):
        super().__init__()
        self.hierarchy = hierarchy
        self.root_categories = list(hierarchy.keys())

        # Level 1: Root classifier
        self.root_classifier = dspy.Predict(
            f"text, root_categories[{', '.join(self.root_categories)}] -> root_category"
        )

        # Level 2: Sub-category classifiers
        self.sub_classifiers = {}
        for root, subs in hierarchy.items():
            subs_str = ", ".join(subs)
            self.sub_classifiers[root] = dspy.Predict(
                f"text, sub_categories[{subs_str}] -> sub_category"
            )

    def forward(self, text):
        # First level classification
        root_result = self.root_classifier(
            text=text,
            root_categories=", ".join(self.root_categories)
        )
        
        root_category = root_result.root_category
        # Handle matching logic...

        # Second level classification
        if root_category in self.sub_classifiers:
            sub_result = self.sub_classifiers[root_category](
                text=text,
                sub_categories=", ".join(self.hierarchy[root_category])
            )
            sub_category = sub_result.sub_category
        else:
            sub_category = "Unknown"

        return dspy.Prediction(
            root_category=root_category,
            sub_category=sub_category,
            full_path=f"{root_category} > {sub_category}"
        )</code></pre>
                                </div>

                                <h3>Confidence-aware Classification</h3>
                                <p>Handling uncertain predictions gracefully:</p>
                                <div class="code-block">
                                    <div class="code-header">
                                        <span class="code-language">Python</span>
                                        <button class="copy-btn" aria-label="Copy code">Copy</button>
                                    </div>
                                    <pre><code class="language-python">class ConfidenceClassifier(dspy.Module):
    def __init__(self, categories, confidence_threshold=0.7):
        super().__init__()
        self.categories = categories
        self.confidence_threshold = confidence_threshold
        self.classify = dspy.Predict(
            f"text, categories[{', '.join(categories)}] -> classification, confidence, uncertainty_analysis"
        )
        self.request_clarification = dspy.Predict("text, uncertainty -> clarification_question")

    def forward(self, text):
        result = self.classify(text=text, categories=", ".join(self.categories))
        confidence = float(result.confidence)

        if confidence < self.confidence_threshold:
            clarification = self.request_clarification(
                text=text,
                uncertainty=result.uncertainty_analysis
            )
            return dspy.Prediction(
                classification="UNCERTAIN",
                confidence=confidence,
                clarification_needed=clarification.clarification_question
            )

        return dspy.Prediction(
            classification=result.classification,
            confidence=confidence
        )</code></pre>
                                </div>
                            </div>

                            <!-- Real-World Applications -->
                            <div class="content-block">
                                <h2>Real-World Application: Support Ticket Router</h2>
                                <p>A practical example of routing customer support tickets:</p>
                                <div class="code-block">
                                    <div class="code-header">
                                        <span class="code-language">Python</span>
                                        <button class="copy-btn" aria-label="Copy code">Copy</button>
                                    </div>
                                    <pre><code class="language-python">class SupportTicketRouter(dspy.Module):
    def __init__(self):
        super().__init__()
        self.departments = [
            "Technical Support", "Billing", "Sales", "Account Management",
            "Product Feedback", "Bug Reports", "Feature Requests"
        ]
        self.priorities = ["Low", "Medium", "High", "Critical", "Urgent"]

        self.department_classifier = dspy.ChainOfThought(
            f"ticket_text, departments[{', '.join(self.departments)}] -> department, reasoning"
        )
        self.priority_classifier = dspy.Predict(
            f"ticket_text, priorities[{', '.join(self.priorities)}] -> priority, urgency_factors"
        )

    def forward(self, ticket_text):
        dept_result = self.department_classifier(
            ticket_text=ticket_text,
            departments=", ".join(self.departments)
        )
        priority_result = self.priority_classifier(
            ticket_text=ticket_text,
            priorities=", ".join(self.priorities)
        )

        return dspy.Prediction(
            department=dept_result.department,
            priority=priority_result.priority,
            department_reasoning=dept_result.reasoning
        )
</code></pre>
                                </div>
                            </div>

                            <!-- Best Practices -->
                            <div class="content-block">
                                <h2>Best Practices</h2>
                                <ul class="feature-list">
                                    <li><strong>Data Quality:</strong> Ensure balanced datasets to avoid bias towards
                                        frequent classes.</li>
                                    <li><strong>Ambiguity:</strong> Use confidence thresholds to flag ambiguous inputs
                                        for human review.</li>
                                    <li><strong>Concept Drift:</strong> Continuously monitor and retrain models as data
                                        patterns change.</li>
                                    <li><strong>Optimization:</strong> Use DSPy optimizers like
                                        <code>BootstrapFewShot</code> to improve classification accuracy with minimal
                                        labeled data.</li>
                                </ul>
                            </div>

                            <!-- Continue -->
                            <div class="content-block">
                                <div class="continue-btn-container">
                                    <a href="entity-extraction.html" class="continue-btn">
                                        <span>Continue to Entity Extraction</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M5 12h14M12 5l7 7-7 7" />
                                        </svg>
                                    </a>
                                </div>
                            </div>

                        </div>
                    </section>
                </article>
            </div>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 DSPy Ebook. All rights reserved.</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="../../assets/js/main.js?v=1"></script>
    <script src="../../assets/js/chapter_v2.js" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (window.initChapter) {
                window.initChapter({});
            }
            setTimeout(() => {
                if (window.Prism) window.Prism.highlightAll();
            }, 100);
        });
    </script>
</body>

</html>